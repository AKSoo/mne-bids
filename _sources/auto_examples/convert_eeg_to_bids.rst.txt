.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_auto_examples_convert_eeg_to_bids.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_convert_eeg_to_bids.py:


===============================
Convert EEG data to BIDS format
===============================

In this example, we use MNE-BIDS to create a BIDS-compatible directory of EEG
data. Specifically, we will follow these steps:

1. Download some EEG data from the
   `PhysioBank database <https://physionet.org/physiobank/database>`_.

2. Load the data, extract information, and save in a new BIDS directory

3. Check the result and compare it with the standard




.. code-block:: python


    # Authors: Stefan Appelhoff <stefan.appelhoff@mailbox.org>
    # License: BSD (3-clause)







We are importing everything we need for this example:



.. code-block:: python

    import os
    import shutil as sh

    from mne.datasets import eegbci
    from mne.io import read_raw_edf

    from mne_bids import raw_to_bids
    from mne_bids.utils import print_dir_tree







Step 1: Download the data
-------------------------

First, we need some data to work with. We will use the
`EEG Motor Movement/Imagery Dataset <https://doi.org/10.13026/C28G6P>`_
available on the PhysioBank database.

The data consists of 109 volunteers performing 14 experimental runs each. For
each subject, there were two baseline tasks (1. eyes open, 2. eyes closed) as
well as four different motor imagery tasks. For the present example, we will
show how to format the data for two subjects and selected tasks to comply
with the Brain Imaging Data Structure
(`BIDS <http://bids.neuroimaging.io/>`).

Conveniently, there is already a data loading function available with
MNE-Python:



.. code-block:: python


    # Make a directory to save the data to
    home = os.path.expanduser('~')
    mne_dir = os.path.join(home, 'mne_data')
    if not os.path.exists(mne_dir):
        os.makedirs(mne_dir)

    # Define which tasks we want to download.
    tasks = [2,  # This is 2 minutes of eyes closed rest
             4,  # This is run #1 of imagining to close left or right fist
             12]  # This is run #2 of imagining to close left or right fist

    # Download the data for subjects 1 and 2
    for subj_idx in [1, 2]:
        eegbci.load_data(subject=subj_idx,
                         runs=tasks,
                         path=mne_dir,
                         update_path=True)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading http://www.physionet.org/physiobank/database/eegmmidb/S001/S001R02.edf (1.2 MB)

    Downloading http://www.physionet.org/physiobank/database/eegmmidb/S001/S001R04.edf (2.5 MB)

    Downloading http://www.physionet.org/physiobank/database/eegmmidb/S001/S001R12.edf (2.5 MB)

    Downloading http://www.physionet.org/physiobank/database/eegmmidb/S002/S002R02.edf (1.2 MB)

    Downloading http://www.physionet.org/physiobank/database/eegmmidb/S002/S002R04.edf (2.4 MB)

    Downloading http://www.physionet.org/physiobank/database/eegmmidb/S002/S002R12.edf (2.4 MB)


Let's see whether the data has been downloaded using a quick visualization
of the directory tree.



.. code-block:: python


    data_dir = os.path.join(mne_dir, 'MNE-eegbci-data')
    print_dir_tree(data_dir)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    |------------ MNE-eegbci-data
    |--------------- physiobank
    |------------------ database
    |--------------------- eegmmidb
    |------------------------ S001
    |--------------------------- S001R12.edf
    |--------------------------- S001R02.edf
    |--------------------------- S001R04.edf
    |------------------------ S002
    |--------------------------- S002R12.edf
    |--------------------------- S002R02.edf
    |--------------------------- S002R04.edf


The data are in the `European Data Format <https://www.edfplus.info/>`_
'.edf', which is good for us because next to the BrainVision format, EDF is
one of the recommended file formats for EEG BIDS. However, apart from the
data format, we need to build a directory structure and supply meta data
files to properly *bidsify* this data.


Step 2: Formatting as BIDS
--------------------------

Let's start by formatting a single subject. We are reading the data using
MNE-Python's io module and the `read_raw_edf` function.



.. code-block:: python

    data_dir = os.path.join(data_dir, 'physiobank', 'database', 'eegmmidb')
    edf_path = os.path.join(data_dir, 'S001', 'S001R02.edf')
    raw = read_raw_edf(edf_path, preload=True)
    print(raw)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S001/S001R02.edf...
    EDF file detected
    EDF annotations detected (consider using raw.find_edf_events() to extract them)
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 9759  =      0.000 ...    60.994 secs...
    <RawEDF  |  S001R02.edf, n_channels x n_times : 65 x 9760 (61.0 sec), ~5.0 MB, data loaded>


With this simple step we have everything to start a new BIDS directory using
our data. To do that, we can use the high level function `raw_to_bids`, which
is the core of MNE-BIDS. Generally, `raw_to_bids` tries to extract as much
meta data as possible from the raw data and then formats it in a BIDS
compatible way. `raw_to_bids` takes a bunch of inputs, most of which are
however optional. The required inputs are:

* subject_id
* task
* raw_file
* output_path

... as you can see in the docstring:



.. code-block:: python

    print(raw_to_bids.__doc__)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Walk over a folder of files and create BIDS compatible folder.

        Parameters
        ----------
        subject_id : str
            The subject name in BIDS compatible format ('01', '02', etc.)
        task : str
            Name of the task the data is based on.
        raw_file : str | instance of mne.Raw
            The raw data. If a string, it is assumed to be the path to the raw data
            file. Otherwise it must be an instance of mne.Raw
        output_path : str
            The path of the BIDS compatible folder
        session_id : str | None
            The session name in BIDS compatible format.
        acquisition : str | None
            Acquisition parameter for the dataset.
        run : int | None
            The run number for this dataset.
        kind : str, one of ('meg', 'eeg', 'ieeg')
            The kind of data being converted. Defaults to "meg".
        events_data : str | array | None
            The events file. If a string, a path to the events file. If an array,
            the MNE events array (shape n_events, 3). If None, events will be
            inferred from the stim channel using `mne.find_events`.
        event_id : dict | None
            The event id dict used to create a 'trial_type' column in events.tsv
        hpi : None | str
            Marker points representing the location of the marker coils with
            respect to the MEG Sensors, or path to a marker file.
        electrode : None | str
            Digitizer points representing the location of the fiducials and the
            marker coils with respect to the digitized head shape, or path to a
            file containing these points.
        hsp : None | str | array, shape = (n_points, 3)
            Digitizer head shape points, or path to head shape file. If more than
            10`000 points are in the head shape, they are automatically decimated.
        eeg_ref : str
            Description of the type of reference used and (when applicable) of
            location of the reference electrode. Defaults to None.
        eeg_gnd : str
            Description  of the location of the ground electrode. Defaults to None.
        config : str | None
            A path to the configuration file to use if the data is from a BTi
            system.
        overwrite : bool
            Whether to overwrite existing files or data in files.
            Defaults to False.
            If overwrite is True, any existing files with the same BIDS parameters
            will be overwritten with the exception of the `participants.tsv` and
            `scans.tsv` files. For these files, parts of pre-existing data that
            match the current data will be replaced.
            If overwrite is False, no existing data will be overwritten or
            replaced.
        verbose : bool
            If verbose is True, this will print a snippet of the sidecar files. If
            False, no content will be printed.

        Notes
        -----
        For the participants.tsv file, the raw.info['subjects_info'] should be
        updated and raw.info['meas_date'] should not be None to compute the age
        of the participant correctly.


We loaded 'S001R02.edf', which corresponds to subject 1 in the second task.
The second task was to rest with closed eyes.



.. code-block:: python

    subject_id = '001'  # zero padding to account for >100 subjects in this dataset
    task = 'resteyesclosed'
    raw_file = raw
    output_path = os.path.join(home, 'mne_data', 'eegmmidb_bids')







Now we just need to specify a few more EEG details to get something sensible:



.. code-block:: python


    # First, tell `MNE-BIDS` that it is working with EEG data:
    kind = 'eeg'

    # Brief description of the event markers present in the data. This will become
    # the `trial_type` column in our BIDS `events.tsv`. We know about the event
    # meaning from the documentation on PhysioBank
    trial_type = {'rest': 0, 'imagine left fist': 1, 'imagine right fist': 2}

    # Now convert our data to be in a new BIDS dataset.
    raw_to_bids(subject_id=subject_id, task=task, raw_file=raw_file,
                output_path=output_path, kind=kind, event_id=trial_type,
                overwrite=False)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Creating folder: /home/circleci/mne_data/eegmmidb_bids/sub-001/eeg

    Writing '/home/circleci/mne_data/eegmmidb_bids/participants.tsv'...

      participant_id  age  sex group
    0        sub-001  NaN  NaN   NaN

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/sub-001_scans.tsv'...

                                      filename acq_time
    0  eeg/sub-001_task-resteyesclosed_eeg.edf      n/a
    1 events found
    Event IDs: [1]

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-resteyesclosed_events.tsv'...

       onset  duration         trial_type  event_value  event_sample
    0    0.0       0.0  imagine left fist            1             0

    Writing '/home/circleci/mne_data/eegmmidb_bids/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.1.1 (draft)"
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-resteyesclosed_eeg.json'...

    {
        "TaskName": "resteyesclosed",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 60.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 1
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-resteyesclosed_channels.tsv'...

       name type units           description  sampling_frequency  low_cutoff  \
    0  Fc5.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    1  Fc3.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    2  Fc1.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    3  Fcz.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    4  Fc2.  EEG     V  ElectroEncephaloGram               160.0         0.0   

       high_cutoff status  
    0         80.0   good  
    1         80.0   good  
    2         80.0   good  
    3         80.0   good  
    4         80.0   good  
    Writing data files to /home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-resteyesclosed_eeg.edf


What does our fresh BIDS directory look like?



.. code-block:: python

    print_dir_tree(output_path)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    |------------ eegmmidb_bids
    |--------------- dataset_description.json
    |--------------- participants.tsv
    |--------------- sub-001
    |------------------ sub-001_scans.tsv
    |------------------ eeg
    |--------------------- sub-001_task-resteyesclosed_eeg.json
    |--------------------- sub-001_task-resteyesclosed_events.tsv
    |--------------------- sub-001_task-resteyesclosed_eeg.edf
    |--------------------- sub-001_task-resteyesclosed_channels.tsv


Looks good so far, let's convert the data for all tasks and subjects.



.. code-block:: python


    # Start with a clean directory
    sh.rmtree(output_path)

    # Some initial information that we found in the PhysioBank documentation
    task_names = {2: 'resteyesclosed',
                  4: 'imaginefists',  # run 1
                  12: 'imaginefists'  # run 2
                  }

    run_mapping = {2: None,  # for resting eyes closed task, there was only one run
                   4: '1',
                   12: '2'
                   }

    # Now go over subjects and *bidsify*
    for subj_idx in [1, 2]:
        for task_idx in [2, 4, 12]:
            # Load the data
            edf_path = os.path.join(data_dir,
                                    'S{:03}'.format(subj_idx),
                                    'S{:03}R{:02}.edf'.format(subj_idx, task_idx))
            raw = read_raw_edf(edf_path, preload=True)

            # `kind` and `trial_type` were already defined above
            raw_to_bids(subject_id='{:03}'.format(subj_idx),
                        task=task_names[task_idx],
                        run=run_mapping[task_idx],
                        raw_file=raw,
                        output_path=output_path,
                        kind=kind,
                        event_id=trial_type,
                        overwrite=True
                        )





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S001/S001R02.edf...
    EDF file detected
    EDF annotations detected (consider using raw.find_edf_events() to extract them)
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 9759  =      0.000 ...    60.994 secs...
    Creating folder: /home/circleci/mne_data/eegmmidb_bids/sub-001/eeg

    Writing '/home/circleci/mne_data/eegmmidb_bids/participants.tsv'...

      participant_id  age  sex group
    0        sub-001  NaN  NaN   NaN

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/sub-001_scans.tsv'...

                                      filename acq_time
    0  eeg/sub-001_task-resteyesclosed_eeg.edf      n/a
    1 events found
    Event IDs: [1]

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-resteyesclosed_events.tsv'...

       onset  duration         trial_type  event_value  event_sample
    0    0.0       0.0  imagine left fist            1             0

    Writing '/home/circleci/mne_data/eegmmidb_bids/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.1.1 (draft)"
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-resteyesclosed_eeg.json'...

    {
        "TaskName": "resteyesclosed",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 60.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 1
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-resteyesclosed_channels.tsv'...

       name type units           description  sampling_frequency  low_cutoff  \
    0  Fc5.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    1  Fc3.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    2  Fc1.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    3  Fcz.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    4  Fc2.  EEG     V  ElectroEncephaloGram               160.0         0.0   

       high_cutoff status  
    0         80.0   good  
    1         80.0   good  
    2         80.0   good  
    3         80.0   good  
    4         80.0   good  
    Writing data files to /home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-resteyesclosed_eeg.edf
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S001/S001R04.edf...
    EDF file detected
    EDF annotations detected (consider using raw.find_edf_events() to extract them)
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids/participants.tsv'...

      participant_id  age  sex group
    0        sub-001  NaN  NaN   NaN

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/sub-001_scans.tsv'...

                                          filename acq_time
    0      eeg/sub-001_task-resteyesclosed_eeg.edf      n/a
    0  eeg/sub-001_task-imaginefists_run-1_eeg.edf      n/a
    30 events found
    Event IDs: [1 2 3]

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-imaginefists_run-1_events.tsv'...

       onset  duration          trial_type  event_value  event_sample
    0    0.0       0.0   imagine left fist            1             0
    1    4.2       0.0                 NaN            3           672
    2    8.3       0.0   imagine left fist            1          1328
    3   12.5       0.0  imagine right fist            2          2000
    4   16.6       0.0   imagine left fist            1          2656

    Writing '/home/circleci/mne_data/eegmmidb_bids/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.1.1 (draft)"
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-imaginefists_run-1_eeg.json'...

    {
        "TaskName": "imaginefists",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 124.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 1
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-imaginefists_run-1_channels.tsv'...

       name type units           description  sampling_frequency  low_cutoff  \
    0  Fc5.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    1  Fc3.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    2  Fc1.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    3  Fcz.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    4  Fc2.  EEG     V  ElectroEncephaloGram               160.0         0.0   

       high_cutoff status  
    0         80.0   good  
    1         80.0   good  
    2         80.0   good  
    3         80.0   good  
    4         80.0   good  
    Writing data files to /home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-imaginefists_run-1_eeg.edf
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S001/S001R12.edf...
    EDF file detected
    EDF annotations detected (consider using raw.find_edf_events() to extract them)
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids/participants.tsv'...

      participant_id  age  sex group
    0        sub-001  NaN  NaN   NaN

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/sub-001_scans.tsv'...

                                          filename acq_time
    0      eeg/sub-001_task-resteyesclosed_eeg.edf      n/a
    1  eeg/sub-001_task-imaginefists_run-1_eeg.edf      n/a
    0  eeg/sub-001_task-imaginefists_run-2_eeg.edf      n/a
    30 events found
    Event IDs: [1 2 3]

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-imaginefists_run-2_events.tsv'...

       onset  duration          trial_type  event_value  event_sample
    0    0.0       0.0   imagine left fist            1             0
    1    4.2       0.0                 NaN            3           672
    2    8.3       0.0   imagine left fist            1          1328
    3   12.5       0.0  imagine right fist            2          2000
    4   16.6       0.0   imagine left fist            1          2656

    Writing '/home/circleci/mne_data/eegmmidb_bids/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.1.1 (draft)"
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-imaginefists_run-2_eeg.json'...

    {
        "TaskName": "imaginefists",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 124.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 1
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-imaginefists_run-2_channels.tsv'...

       name type units           description  sampling_frequency  low_cutoff  \
    0  Fc5.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    1  Fc3.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    2  Fc1.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    3  Fcz.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    4  Fc2.  EEG     V  ElectroEncephaloGram               160.0         0.0   

       high_cutoff status  
    0         80.0   good  
    1         80.0   good  
    2         80.0   good  
    3         80.0   good  
    4         80.0   good  
    Writing data files to /home/circleci/mne_data/eegmmidb_bids/sub-001/eeg/sub-001_task-imaginefists_run-2_eeg.edf
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S002/S002R02.edf...
    EDF file detected
    EDF annotations detected (consider using raw.find_edf_events() to extract them)
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 9759  =      0.000 ...    60.994 secs...
    Creating folder: /home/circleci/mne_data/eegmmidb_bids/sub-002/eeg

    Writing '/home/circleci/mne_data/eegmmidb_bids/participants.tsv'...

      participant_id  age  sex group
    0        sub-001  n/a  n/a   n/a
    0        sub-002  NaN  NaN   NaN

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/sub-002_scans.tsv'...

                                      filename acq_time
    0  eeg/sub-002_task-resteyesclosed_eeg.edf      n/a
    1 events found
    Event IDs: [1]

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-resteyesclosed_events.tsv'...

       onset  duration         trial_type  event_value  event_sample
    0    0.0       0.0  imagine left fist            1             0

    Writing '/home/circleci/mne_data/eegmmidb_bids/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.1.1 (draft)"
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-resteyesclosed_eeg.json'...

    {
        "TaskName": "resteyesclosed",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 60.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 1
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-resteyesclosed_channels.tsv'...

       name type units           description  sampling_frequency  low_cutoff  \
    0  Fc5.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    1  Fc3.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    2  Fc1.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    3  Fcz.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    4  Fc2.  EEG     V  ElectroEncephaloGram               160.0         0.0   

       high_cutoff status  
    0         80.0   good  
    1         80.0   good  
    2         80.0   good  
    3         80.0   good  
    4         80.0   good  
    Writing data files to /home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-resteyesclosed_eeg.edf
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S002/S002R04.edf...
    EDF file detected
    EDF annotations detected (consider using raw.find_edf_events() to extract them)
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19679  =      0.000 ...   122.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids/participants.tsv'...

      participant_id  age  sex group
    0        sub-001  n/a  n/a   n/a
    0        sub-002  NaN  NaN   NaN

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/sub-002_scans.tsv'...

                                          filename acq_time
    0      eeg/sub-002_task-resteyesclosed_eeg.edf      n/a
    0  eeg/sub-002_task-imaginefists_run-1_eeg.edf      n/a
    30 events found
    Event IDs: [1 2 3]

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-imaginefists_run-1_events.tsv'...

       onset  duration          trial_type  event_value  event_sample
    0    0.0       0.0   imagine left fist            1             0
    1    4.1       0.0  imagine right fist            2           656
    2    8.2       0.0   imagine left fist            1          1312
    3   12.3       0.0                 NaN            3          1968
    4   16.4       0.0   imagine left fist            1          2624

    Writing '/home/circleci/mne_data/eegmmidb_bids/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.1.1 (draft)"
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-imaginefists_run-1_eeg.json'...

    {
        "TaskName": "imaginefists",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 122.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 1
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-imaginefists_run-1_channels.tsv'...

       name type units           description  sampling_frequency  low_cutoff  \
    0  Fc5.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    1  Fc3.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    2  Fc1.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    3  Fcz.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    4  Fc2.  EEG     V  ElectroEncephaloGram               160.0         0.0   

       high_cutoff status  
    0         80.0   good  
    1         80.0   good  
    2         80.0   good  
    3         80.0   good  
    4         80.0   good  
    Writing data files to /home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-imaginefists_run-1_eeg.edf
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/physiobank/database/eegmmidb/S002/S002R12.edf...
    EDF file detected
    EDF annotations detected (consider using raw.find_edf_events() to extract them)
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19679  =      0.000 ...   122.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids/participants.tsv'...

      participant_id  age  sex group
    0        sub-001  n/a  n/a   n/a
    0        sub-002  NaN  NaN   NaN

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/sub-002_scans.tsv'...

                                          filename acq_time
    0      eeg/sub-002_task-resteyesclosed_eeg.edf      n/a
    1  eeg/sub-002_task-imaginefists_run-1_eeg.edf      n/a
    0  eeg/sub-002_task-imaginefists_run-2_eeg.edf      n/a
    30 events found
    Event IDs: [1 2 3]

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-imaginefists_run-2_events.tsv'...

       onset  duration          trial_type  event_value  event_sample
    0    0.0       0.0   imagine left fist            1             0
    1    4.1       0.0  imagine right fist            2           656
    2    8.2       0.0   imagine left fist            1          1312
    3   12.3       0.0                 NaN            3          1968
    4   16.4       0.0   imagine left fist            1          2624

    Writing '/home/circleci/mne_data/eegmmidb_bids/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.1.1 (draft)"
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-imaginefists_run-2_eeg.json'...

    {
        "TaskName": "imaginefists",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 122.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 1
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-imaginefists_run-2_channels.tsv'...

       name type units           description  sampling_frequency  low_cutoff  \
    0  Fc5.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    1  Fc3.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    2  Fc1.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    3  Fcz.  EEG     V  ElectroEncephaloGram               160.0         0.0   
    4  Fc2.  EEG     V  ElectroEncephaloGram               160.0         0.0   

       high_cutoff status  
    0         80.0   good  
    1         80.0   good  
    2         80.0   good  
    3         80.0   good  
    4         80.0   good  
    Writing data files to /home/circleci/mne_data/eegmmidb_bids/sub-002/eeg/sub-002_task-imaginefists_run-2_eeg.edf


Step 3: Check and compare with standard
---------------------------------------
Now we have written our BIDS directory.



.. code-block:: python

    print_dir_tree(output_path)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    |------------ eegmmidb_bids
    |--------------- dataset_description.json
    |--------------- participants.tsv
    |--------------- sub-001
    |------------------ sub-001_scans.tsv
    |------------------ eeg
    |--------------------- sub-001_task-imaginefists_run-1_events.tsv
    |--------------------- sub-001_task-imaginefists_run-2_eeg.json
    |--------------------- sub-001_task-resteyesclosed_eeg.json
    |--------------------- sub-001_task-imaginefists_run-2_events.tsv
    |--------------------- sub-001_task-imaginefists_run-1_channels.tsv
    |--------------------- sub-001_task-imaginefists_run-2_eeg.edf
    |--------------------- sub-001_task-resteyesclosed_events.tsv
    |--------------------- sub-001_task-imaginefists_run-2_channels.tsv
    |--------------------- sub-001_task-imaginefists_run-1_eeg.json
    |--------------------- sub-001_task-resteyesclosed_eeg.edf
    |--------------------- sub-001_task-imaginefists_run-1_eeg.edf
    |--------------------- sub-001_task-resteyesclosed_channels.tsv
    |--------------- sub-002
    |------------------ sub-002_scans.tsv
    |------------------ eeg
    |--------------------- sub-002_task-resteyesclosed_events.tsv
    |--------------------- sub-002_task-imaginefists_run-2_events.tsv
    |--------------------- sub-002_task-imaginefists_run-1_channels.tsv
    |--------------------- sub-002_task-resteyesclosed_channels.tsv
    |--------------------- sub-002_task-imaginefists_run-2_channels.tsv
    |--------------------- sub-002_task-resteyesclosed_eeg.edf
    |--------------------- sub-002_task-imaginefists_run-2_eeg.json
    |--------------------- sub-002_task-imaginefists_run-2_eeg.edf
    |--------------------- sub-002_task-imaginefists_run-1_events.tsv
    |--------------------- sub-002_task-resteyesclosed_eeg.json
    |--------------------- sub-002_task-imaginefists_run-1_eeg.edf
    |--------------------- sub-002_task-imaginefists_run-1_eeg.json


MNE-BIDS has created a suitable directory structure for us, and among other
meta data files, it started an `events.tsv` and `channels.tsv` and made an
initial `dataset_description` on top!

Now it's time to manually check the BIDS directory and the meta files to add
all the information that MNE-BIDS could not infer. These places are marked
with "n/a".

Remember that there is a convenient javascript tool to validate all your BIDS
directories called the "BIDS-validator", available as a web version and a
command line tool:

Web version: https://bids-standard.github.io/bids-validator/

Command line tool: https://www.npmjs.com/package/bids-validator


**Total running time of the script:** ( 0 minutes  46.864 seconds)


.. _sphx_glr_download_auto_examples_convert_eeg_to_bids.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: convert_eeg_to_bids.py <convert_eeg_to_bids.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: convert_eeg_to_bids.ipynb <convert_eeg_to_bids.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
