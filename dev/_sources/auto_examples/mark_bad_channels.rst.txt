.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_mark_bad_channels.py>`     to download the full example code or to run this example in your browser via Binder
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_auto_examples_mark_bad_channels.py:


=========================================================
03. Interactive data inspection and bad channel selection
=========================================================

You can use MNE-BIDS interactively inspect your  MEG or (i)EEG data.
Problematic channels can be marked as "bad", for example if the connected
sensor produced mostly noise – or no signal at all. Similarly, you can declare
channels as "good", should you discover they were incorrectly marked as bad.
Bad channel selection can also be performed non-interactively.

Furthermore, you can view and edit the experimental events and mark time
segments as "bad".

.. _MNE-Python Annotations tutorial: https://mne.tools/stable/auto_tutorials/raw/plot_30_annotate_raw.html#annotating-raw-objects-interactively


.. code-block:: default


    # Authors: Richard Höchenberger <richard.hoechenberger@gmail.com>
    # License: BSD (3-clause)








We will demonstrate how to mark individual channels as bad on the MNE
"sample" dataset. After that, we will mark channels as good again.

Let's start by importing the required modules and functions, reading the
"sample" data, and writing it in the BIDS format.


.. code-block:: default


    import os.path as op
    import shutil

    import mne
    from mne_bids import (BIDSPath, write_raw_bids, read_raw_bids,
                          inspect_dataset, mark_bad_channels)

    data_path = mne.datasets.sample.data_path()
    raw_fname = op.join(data_path, 'MEG', 'sample', 'sample_audvis_raw.fif')
    events_fname = op.join(data_path, 'MEG', 'sample', 'sample_audvis_raw-eve.fif')
    event_id = {'Auditory/Left': 1, 'Auditory/Right': 2, 'Visual/Left': 3,
                'Visual/Right': 4, 'Smiley': 5, 'Button': 32}
    bids_root = op.join(data_path, '..', 'MNE-sample-data-bids')
    bids_path = BIDSPath(subject='01', session='01', task='audiovisual', run='01',
                         root=bids_root)








To ensure the output path doesn't contain any leftover files from previous
tests and example runs, we simply delete it.

.. warning:: Do not delete directories that may contain important data!



.. code-block:: default


    if op.exists(bids_root):
        shutil.rmtree(bids_root)








Now write the raw data to BIDS.


.. code-block:: default


    raw = mne.io.read_raw_fif(raw_fname, verbose=False)
    raw.info['line_freq'] = 60  # Specify power line frequency as required by BIDS.
    write_raw_bids(raw, bids_path=bids_path, events_data=events_fname,
                   event_id=event_id, overwrite=True, verbose=False)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    BIDSPath(
    root: /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids
    datatype: meg
    basename: sub-01_ses-01_task-audiovisual_run-01_meg.fif)



Interactive use
---------------

Using :func:`mne_bids.inspect_dataset`, we can interactively explore the raw
data and toggle the channel status – ``bad`` or ``good`` – by clicking on the
respective traces or channel names. If there are any SSP projectors stored
with the data, a small popup window will allow you to toggle the projectors
on and off. If you changed the selection of bad channels, you will be
prompted whether you would like to save the changes when closing the main
window. Your raw data and the `*_channels.tsv` sidecar file will be updated
upon saving.


.. code-block:: default


    inspect_dataset(bids_path)




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/images/sphx_glr_mark_bad_channels_001.png
          :alt: mark bad channels
          :class: sphx-glr-multi-img

    *

      .. image:: /auto_examples/images/sphx_glr_mark_bad_channels_002.png
          :alt: Projectors marked with "X" are active on the plot.
          :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Opening raw data file /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_meg.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Reading events from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_events.tsv.
    Reading channel info from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_channels.tsv.
    /home/circleci/project/mne_bids/read.py:339: RuntimeWarning: The unit for channel(s) STI 001, STI 002, STI 003, STI 004, STI 005, STI 006, STI 014, STI 015, STI 016 has changed from V to NA.
      raw.set_channel_types(channel_type_dict)
    Reading 0 ... 166799  =      0.000 ...   277.714 secs...
    Finding flat segments
      0%|          | Channels : 0/364 [00:00<?,       ?it/s]      1%|          | Channels : 2/364 [00:00<00:06,   59.63it/s]      1%|1         | Channels : 4/364 [00:00<00:05,   60.37it/s]      1%|1         | Channels : 5/364 [00:00<00:05,   60.46it/s]      2%|1         | Channels : 7/364 [00:00<00:05,   61.02it/s]      2%|2         | Channels : 9/364 [00:00<00:05,   61.94it/s]      3%|3         | Channels : 11/364 [00:00<00:05,   62.00it/s]      4%|3         | Channels : 13/364 [00:00<00:05,   62.88it/s]      4%|3         | Channels : 14/364 [00:00<00:05,   62.77it/s]      4%|4         | Channels : 16/364 [00:00<00:05,   62.72it/s]      5%|4         | Channels : 17/364 [00:00<00:05,   62.66it/s]      5%|5         | Channels : 19/364 [00:00<00:05,   63.09it/s]      5%|5         | Channels : 20/364 [00:00<00:05,   62.97it/s]      6%|6         | Channels : 22/364 [00:00<00:05,   63.55it/s]      7%|6         | Channels : 24/364 [00:00<00:05,   64.45it/s]      7%|7         | Channels : 26/364 [00:00<00:05,   64.55it/s]      8%|7         | Channels : 28/364 [00:00<00:05,   65.09it/s]      8%|7         | Channels : 29/364 [00:00<00:05,   64.47it/s]      9%|8         | Channels : 31/364 [00:00<00:05,   64.94it/s]      9%|8         | Channels : 32/364 [00:00<00:05,   64.50it/s]      9%|9         | Channels : 34/364 [00:00<00:05,   65.50it/s]     10%|9         | Channels : 36/364 [00:00<00:04,   66.31it/s]     10%|#         | Channels : 37/364 [00:00<00:04,   65.88it/s]     10%|#         | Channels : 38/364 [00:00<00:04,   65.22it/s]     11%|#         | Channels : 40/364 [00:00<00:04,   65.93it/s]     11%|#1        | Channels : 41/364 [00:00<00:04,   65.56it/s]     12%|#1        | Channels : 43/364 [00:00<00:04,   66.81it/s]     12%|#2        | Channels : 45/364 [00:00<00:04,   67.59it/s]     13%|#2        | Channels : 47/364 [00:00<00:04,   67.53it/s]     13%|#3        | Channels : 49/364 [00:00<00:04,   68.37it/s]     14%|#4        | Channels : 51/364 [00:00<00:04,   68.96it/s]     15%|#4        | Channels : 53/364 [00:00<00:04,   68.85it/s]     15%|#5        | Channels : 55/364 [00:00<00:04,   69.13it/s]     16%|#5        | Channels : 57/364 [00:00<00:04,   69.71it/s]     16%|#5        | Channels : 58/364 [00:00<00:04,   68.73it/s]     16%|#6        | Channels : 60/364 [00:00<00:04,   69.34it/s]     17%|#6        | Channels : 61/364 [00:00<00:04,   68.66it/s]     17%|#7        | Channels : 62/364 [00:00<00:04,   67.73it/s]     18%|#7        | Channels : 64/364 [00:00<00:04,   68.21it/s]     18%|#7        | Channels : 65/364 [00:00<00:04,   67.23it/s]     18%|#8        | Channels : 67/364 [00:00<00:04,   68.08it/s]     19%|#8        | Channels : 68/364 [00:00<00:04,   67.31it/s]     19%|#9        | Channels : 70/364 [00:00<00:04,   67.82it/s]     20%|#9        | Channels : 71/364 [00:00<00:04,   67.21it/s]     20%|##        | Channels : 73/364 [00:01<00:04,   67.87it/s]     21%|##        | Channels : 75/364 [00:01<00:04,   68.60it/s]     21%|##1       | Channels : 77/364 [00:01<00:04,   68.50it/s]     22%|##1       | Channels : 79/364 [00:01<00:04,   69.11it/s]     22%|##1       | Channels : 80/364 [00:01<00:04,   68.43it/s]     23%|##2       | Channels : 82/364 [00:01<00:04,   68.97it/s]     23%|##2       | Channels : 83/364 [00:01<00:04,   68.51it/s]     23%|##3       | Channels : 85/364 [00:01<00:04,   69.21it/s]     24%|##3       | Channels : 87/364 [00:01<00:03,   69.77it/s]     24%|##4       | Channels : 88/364 [00:01<00:04,   68.12it/s]     25%|##4       | Channels : 90/364 [00:01<00:04,   68.40it/s]     25%|##5       | Channels : 91/364 [00:01<00:04,   67.87it/s]     25%|##5       | Channels : 92/364 [00:01<00:04,   67.28it/s]     26%|##5       | Channels : 94/364 [00:01<00:04,   67.43it/s]     26%|##6       | Channels : 95/364 [00:01<00:04,   66.74it/s]     27%|##6       | Channels : 97/364 [00:01<00:03,   66.88it/s]     27%|##6       | Channels : 98/364 [00:01<00:03,   66.57it/s]     27%|##7       | Channels : 100/364 [00:01<00:03,   66.99it/s]     28%|##7       | Channels : 101/364 [00:01<00:03,   66.53it/s]     28%|##8       | Channels : 103/364 [00:01<00:03,   67.00it/s]     29%|##8       | Channels : 104/364 [00:01<00:03,   66.24it/s]     29%|##9       | Channels : 106/364 [00:01<00:03,   67.01it/s]     30%|##9       | Channels : 108/364 [00:01<00:03,   67.64it/s]     30%|###       | Channels : 110/364 [00:01<00:03,   67.59it/s]     31%|###       | Channels : 112/364 [00:01<00:03,   68.18it/s]     31%|###1      | Channels : 113/364 [00:01<00:03,   67.44it/s]     32%|###1      | Channels : 115/364 [00:01<00:03,   68.09it/s]     32%|###1      | Channels : 116/364 [00:01<00:03,   67.76it/s]     32%|###2      | Channels : 118/364 [00:01<00:03,   68.36it/s]     33%|###2      | Channels : 119/364 [00:01<00:03,   67.61it/s]     33%|###3      | Channels : 121/364 [00:01<00:03,   68.34it/s]     34%|###3      | Channels : 123/364 [00:01<00:03,   69.05it/s]     34%|###4      | Channels : 125/364 [00:01<00:03,   69.01it/s]     35%|###4      | Channels : 127/364 [00:01<00:03,   69.55it/s]     35%|###5      | Channels : 128/364 [00:01<00:03,   68.66it/s]     36%|###5      | Channels : 130/364 [00:01<00:03,   69.01it/s]     36%|###6      | Channels : 132/364 [00:01<00:03,   69.53it/s]     37%|###6      | Channels : 133/364 [00:01<00:03,   69.05it/s]     37%|###7      | Channels : 135/364 [00:01<00:03,   69.67it/s]     37%|###7      | Channels : 136/364 [00:01<00:03,   69.10it/s]     38%|###7      | Channels : 137/364 [00:01<00:03,   68.13it/s]     38%|###8      | Channels : 139/364 [00:01<00:03,   68.44it/s]     39%|###8      | Channels : 141/364 [00:01<00:03,   69.00it/s]     39%|###9      | Channels : 143/364 [00:01<00:03,   69.04it/s]     40%|###9      | Channels : 145/364 [00:01<00:03,   69.92it/s]     40%|####      | Channels : 147/364 [00:02<00:03,   70.85it/s]     41%|####      | Channels : 148/364 [00:02<00:03,   69.99it/s]     41%|####1     | Channels : 150/364 [00:02<00:03,   70.45it/s]     41%|####1     | Channels : 151/364 [00:02<00:03,   69.45it/s]     42%|####1     | Channels : 152/364 [00:02<00:03,   68.83it/s]     42%|####2     | Channels : 154/364 [00:02<00:03,   67.56it/s]     43%|####2     | Channels : 155/364 [00:02<00:03,   65.82it/s]     43%|####3     | Channels : 157/364 [00:02<00:03,   66.43it/s]     43%|####3     | Channels : 158/364 [00:02<00:03,   66.04it/s]     44%|####3     | Channels : 160/364 [00:02<00:03,   66.70it/s]     45%|####4     | Channels : 162/364 [00:02<00:02,   67.55it/s]     45%|####4     | Channels : 163/364 [00:02<00:02,   67.13it/s]     45%|####5     | Channels : 165/364 [00:02<00:02,   67.61it/s]     46%|####5     | Channels : 167/364 [00:02<00:02,   67.55it/s]     46%|####6     | Channels : 169/364 [00:02<00:02,   68.27it/s]     47%|####6     | Channels : 171/364 [00:02<00:02,   68.90it/s]     48%|####7     | Channels : 173/364 [00:02<00:02,   68.34it/s]     48%|####8     | Channels : 175/364 [00:02<00:02,   68.94it/s]     48%|####8     | Channels : 176/364 [00:02<00:02,   67.36it/s]     49%|####8     | Channels : 178/364 [00:02<00:02,   68.04it/s]     49%|####9     | Channels : 179/364 [00:02<00:02,   67.70it/s]     50%|####9     | Channels : 181/364 [00:02<00:02,   68.47it/s]     50%|#####     | Channels : 183/364 [00:02<00:02,   68.97it/s]     51%|#####     | Channels : 185/364 [00:02<00:02,   69.04it/s]     51%|#####1    | Channels : 187/364 [00:02<00:02,   69.49it/s]     52%|#####1    | Channels : 188/364 [00:02<00:02,   68.58it/s]     52%|#####2    | Channels : 190/364 [00:02<00:02,   69.15it/s]     52%|#####2    | Channels : 191/364 [00:02<00:02,   68.44it/s]     53%|#####3    | Channels : 193/364 [00:02<00:02,   69.32it/s]     53%|#####3    | Channels : 194/364 [00:02<00:02,   68.69it/s]     54%|#####3    | Channels : 196/364 [00:02<00:02,   69.30it/s]     54%|#####4    | Channels : 197/364 [00:02<00:02,   68.75it/s]     55%|#####4    | Channels : 199/364 [00:02<00:02,   69.30it/s]     55%|#####5    | Channels : 201/364 [00:02<00:02,   69.87it/s]     55%|#####5    | Channels : 202/364 [00:02<00:02,   69.41it/s]     56%|#####5    | Channels : 203/364 [00:02<00:02,   68.91it/s]     56%|#####6    | Channels : 205/364 [00:02<00:02,   68.61it/s]     57%|#####6    | Channels : 206/364 [00:02<00:02,   67.57it/s]     57%|#####7    | Channels : 208/364 [00:02<00:02,   68.17it/s]     58%|#####7    | Channels : 210/364 [00:02<00:02,   68.85it/s]     58%|#####8    | Channels : 212/364 [00:02<00:02,   68.64it/s]     59%|#####8    | Channels : 214/364 [00:02<00:02,   68.91it/s]     59%|#####9    | Channels : 216/364 [00:02<00:02,   69.38it/s]     60%|#####9    | Channels : 217/364 [00:03<00:02,   68.86it/s]     60%|######    | Channels : 219/364 [00:03<00:02,   69.46it/s]     61%|######    | Channels : 221/364 [00:03<00:02,   69.45it/s]     61%|######1   | Channels : 223/364 [00:03<00:02,   69.70it/s]     62%|######1   | Channels : 224/364 [00:03<00:02,   69.28it/s]     62%|######1   | Channels : 225/364 [00:03<00:02,   67.92it/s]     62%|######2   | Channels : 226/364 [00:03<00:02,   66.13it/s]     62%|######2   | Channels : 227/364 [00:03<00:02,   65.54it/s]     63%|######2   | Channels : 229/364 [00:03<00:02,   66.24it/s]     63%|######3   | Channels : 231/364 [00:03<00:01,   67.10it/s]     64%|######4   | Channels : 233/364 [00:03<00:01,   66.93it/s]     65%|######4   | Channels : 235/364 [00:03<00:01,   67.27it/s]     65%|######5   | Channels : 237/364 [00:03<00:01,   67.88it/s]     66%|######5   | Channels : 239/364 [00:03<00:01,   67.62it/s]     66%|######6   | Channels : 241/364 [00:03<00:01,   68.00it/s]     66%|######6   | Channels : 242/364 [00:03<00:01,   67.55it/s]     67%|######7   | Channels : 244/364 [00:03<00:01,   68.33it/s]     67%|######7   | Channels : 245/364 [00:03<00:01,   67.89it/s]     68%|######7   | Channels : 247/364 [00:03<00:01,   68.38it/s]     68%|######8   | Channels : 249/364 [00:03<00:01,   69.15it/s]     69%|######8   | Channels : 251/364 [00:03<00:01,   69.08it/s]     70%|######9   | Channels : 253/364 [00:03<00:01,   69.47it/s]     70%|######9   | Channels : 254/364 [00:03<00:01,   68.85it/s]     70%|#######   | Channels : 256/364 [00:03<00:01,   69.25it/s]     71%|#######   | Channels : 258/364 [00:03<00:01,   69.85it/s]     71%|#######1  | Channels : 259/364 [00:03<00:01,   69.21it/s]     71%|#######1  | Channels : 260/364 [00:03<00:01,   66.72it/s]     72%|#######1  | Channels : 262/364 [00:03<00:01,   67.23it/s]     72%|#######2  | Channels : 263/364 [00:03<00:01,   66.94it/s]     73%|#######2  | Channels : 265/364 [00:03<00:01,   67.23it/s]     73%|#######3  | Channels : 266/364 [00:03<00:01,   66.87it/s]     74%|#######3  | Channels : 268/364 [00:03<00:01,   67.09it/s]     74%|#######4  | Channels : 270/364 [00:03<00:01,   67.69it/s]     74%|#######4  | Channels : 271/364 [00:03<00:01,   67.34it/s]     75%|#######5  | Channels : 273/364 [00:03<00:01,   68.03it/s]     76%|#######5  | Channels : 275/364 [00:03<00:01,   68.52it/s]     76%|#######6  | Channels : 277/364 [00:03<00:01,   69.44it/s]     77%|#######6  | Channels : 279/364 [00:03<00:01,   70.24it/s]     77%|#######7  | Channels : 281/364 [00:03<00:01,   70.74it/s]     77%|#######7  | Channels : 282/364 [00:03<00:01,   69.67it/s]     78%|#######7  | Channels : 283/364 [00:03<00:01,   68.49it/s]     78%|#######8  | Channels : 285/364 [00:03<00:01,   68.91it/s]     79%|#######8  | Channels : 287/364 [00:03<00:01,   69.18it/s]     79%|#######9  | Channels : 288/364 [00:04<00:01,   67.60it/s]     80%|#######9  | Channels : 290/364 [00:04<00:01,   67.99it/s]     80%|#######9  | Channels : 291/364 [00:04<00:01,   67.44it/s]     80%|########  | Channels : 292/364 [00:04<00:01,   67.14it/s]     81%|########  | Channels : 294/364 [00:04<00:01,   67.49it/s]     81%|########1 | Channels : 296/364 [00:04<00:00,   68.09it/s]     82%|########1 | Channels : 298/364 [00:04<00:00,   67.59it/s]     82%|########2 | Channels : 300/364 [00:04<00:00,   67.93it/s]     83%|########2 | Channels : 301/364 [00:04<00:00,   67.43it/s]     83%|########3 | Channels : 303/364 [00:04<00:00,   67.76it/s]     84%|########3 | Channels : 304/364 [00:04<00:00,   67.33it/s]     85%|########4 | Channels : 308/364 [00:04<00:00,   69.77it/s]     87%|########6 | Channels : 316/364 [00:04<00:00,   72.81it/s]     88%|########8 | Channels : 322/364 [00:04<00:00,   75.85it/s]     90%|######### | Channels : 329/364 [00:04<00:00,   79.09it/s]     92%|#########2| Channels : 335/364 [00:04<00:00,   82.24it/s]     94%|#########3| Channels : 341/364 [00:04<00:00,   85.46it/s]     95%|#########5| Channels : 346/364 [00:04<00:00,   88.68it/s]     97%|#########6| Channels : 352/364 [00:04<00:00,   92.01it/s]     98%|#########8| Channels : 357/364 [00:04<00:00,   95.26it/s]    100%|#########9| Channels : 363/364 [00:04<00:00,   98.74it/s]    100%|##########| Channels : 364/364 [00:04<00:00,   82.48it/s]
    Marking 0.00% of time points (0 segments) and 0/364 channels bad




You can even apply frequency filters when viewing the data: A high-pass
filter can remove slow drifts, while a low-pass filter will get rid of
high-frequency artifacts. This can make visual inspection easier. Let's
apply filters with a 1-Hz high-pass cutoff, and a 30-Hz low-pass cutoff:


.. code-block:: default


    inspect_dataset(bids_path, l_freq=1., h_freq=30.)




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/images/sphx_glr_mark_bad_channels_003.png
          :alt: mark bad channels
          :class: sphx-glr-multi-img

    *

      .. image:: /auto_examples/images/sphx_glr_mark_bad_channels_004.png
          :alt: Projectors marked with "X" are active on the plot.
          :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Opening raw data file /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_meg.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Reading events from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_events.tsv.
    Reading channel info from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_channels.tsv.
    /home/circleci/project/mne_bids/read.py:339: RuntimeWarning: The unit for channel(s) STI 001, STI 002, STI 003, STI 004, STI 005, STI 006, STI 014, STI 015, STI 016 has changed from V to NA.
      raw.set_channel_types(channel_type_dict)
    Reading 0 ... 166799  =      0.000 ...   277.714 secs...
    Finding flat segments
      0%|          | Channels : 0/364 [00:00<?,       ?it/s]      0%|          | Channels : 1/364 [00:00<00:06,   59.85it/s]      1%|          | Channels : 2/364 [00:00<00:06,   59.52it/s]      1%|1         | Channels : 4/364 [00:00<00:05,   60.25it/s]      1%|1         | Channels : 5/364 [00:00<00:05,   60.27it/s]      2%|1         | Channels : 7/364 [00:00<00:05,   60.83it/s]      2%|2         | Channels : 9/364 [00:00<00:05,   61.68it/s]      3%|2         | Channels : 10/364 [00:00<00:05,   61.64it/s]      3%|3         | Channels : 11/364 [00:00<00:05,   61.52it/s]      4%|3         | Channels : 13/364 [00:00<00:05,   62.26it/s]      4%|3         | Channels : 14/364 [00:00<00:05,   62.27it/s]      4%|4         | Channels : 16/364 [00:00<00:05,   62.77it/s]      5%|4         | Channels : 18/364 [00:00<00:05,   63.56it/s]      5%|5         | Channels : 19/364 [00:00<00:05,   62.93it/s]      5%|5         | Channels : 20/364 [00:00<00:05,   62.75it/s]      6%|6         | Channels : 22/364 [00:00<00:05,   63.60it/s]      7%|6         | Channels : 24/364 [00:00<00:05,   64.71it/s]      7%|7         | Channels : 26/364 [00:00<00:05,   64.77it/s]      8%|7         | Channels : 28/364 [00:00<00:05,   65.30it/s]      8%|7         | Channels : 29/364 [00:00<00:05,   65.04it/s]      9%|8         | Channels : 31/364 [00:00<00:05,   65.65it/s]      9%|8         | Channels : 32/364 [00:00<00:05,   64.50it/s]      9%|9         | Channels : 34/364 [00:00<00:05,   65.17it/s]     10%|9         | Channels : 36/364 [00:00<00:04,   65.92it/s]     10%|#         | Channels : 37/364 [00:00<00:04,   65.49it/s]     10%|#         | Channels : 38/364 [00:00<00:05,   64.18it/s]     11%|#         | Channels : 40/364 [00:00<00:04,   64.81it/s]     11%|#1        | Channels : 41/364 [00:00<00:05,   64.55it/s]     12%|#1        | Channels : 43/364 [00:00<00:04,   65.80it/s]     12%|#2        | Channels : 45/364 [00:00<00:04,   66.57it/s]     13%|#2        | Channels : 47/364 [00:00<00:04,   66.68it/s]     13%|#3        | Channels : 49/364 [00:00<00:04,   67.50it/s]     14%|#4        | Channels : 51/364 [00:00<00:04,   68.10it/s]     15%|#4        | Channels : 53/364 [00:00<00:04,   68.08it/s]     15%|#5        | Channels : 55/364 [00:00<00:04,   68.39it/s]     15%|#5        | Channels : 56/364 [00:00<00:04,   68.05it/s]     16%|#5        | Channels : 58/364 [00:00<00:04,   68.48it/s]     16%|#6        | Channels : 60/364 [00:00<00:04,   69.09it/s]     17%|#6        | Channels : 61/364 [00:00<00:04,   68.30it/s]     17%|#7        | Channels : 62/364 [00:00<00:04,   67.35it/s]     18%|#7        | Channels : 64/364 [00:00<00:04,   67.82it/s]     18%|#7        | Channels : 65/364 [00:00<00:04,   67.38it/s]     18%|#8        | Channels : 67/364 [00:00<00:04,   68.31it/s]     19%|#8        | Channels : 68/364 [00:00<00:04,   67.97it/s]     19%|#9        | Channels : 70/364 [00:00<00:04,   68.47it/s]     20%|#9        | Channels : 71/364 [00:00<00:04,   67.94it/s]     20%|##        | Channels : 73/364 [00:01<00:04,   68.63it/s]     21%|##        | Channels : 75/364 [00:01<00:04,   69.39it/s]     21%|##1       | Channels : 77/364 [00:01<00:04,   69.22it/s]     22%|##1       | Channels : 79/364 [00:01<00:04,   69.81it/s]     22%|##1       | Channels : 80/364 [00:01<00:04,   68.93it/s]     23%|##2       | Channels : 82/364 [00:01<00:04,   69.29it/s]     23%|##2       | Channels : 83/364 [00:01<00:04,   68.80it/s]     23%|##3       | Channels : 85/364 [00:01<00:04,   69.53it/s]     24%|##3       | Channels : 87/364 [00:01<00:03,   70.08it/s]     24%|##4       | Channels : 88/364 [00:01<00:03,   69.19it/s]     24%|##4       | Channels : 89/364 [00:01<00:03,   68.81it/s]     25%|##5       | Channels : 91/364 [00:01<00:03,   69.33it/s]     25%|##5       | Channels : 92/364 [00:01<00:03,   68.58it/s]     26%|##5       | Channels : 94/364 [00:01<00:03,   68.93it/s]     26%|##6       | Channels : 95/364 [00:01<00:03,   68.31it/s]     27%|##6       | Channels : 97/364 [00:01<00:03,   68.36it/s]     27%|##6       | Channels : 98/364 [00:01<00:03,   67.78it/s]     27%|##7       | Channels : 100/364 [00:01<00:03,   67.96it/s]     28%|##8       | Channels : 102/364 [00:01<00:03,   68.48it/s]     28%|##8       | Channels : 103/364 [00:01<00:03,   68.01it/s]     29%|##8       | Channels : 104/364 [00:01<00:03,   67.10it/s]     29%|##9       | Channels : 106/364 [00:01<00:03,   67.72it/s]     30%|##9       | Channels : 108/364 [00:01<00:03,   68.32it/s]     30%|###       | Channels : 110/364 [00:01<00:03,   68.18it/s]     31%|###       | Channels : 112/364 [00:01<00:03,   68.64it/s]     31%|###1      | Channels : 113/364 [00:01<00:03,   67.89it/s]     32%|###1      | Channels : 115/364 [00:01<00:03,   68.59it/s]     32%|###2      | Channels : 117/364 [00:01<00:03,   69.20it/s]     33%|###2      | Channels : 119/364 [00:01<00:03,   68.80it/s]     33%|###3      | Channels : 121/364 [00:01<00:03,   69.50it/s]     34%|###3      | Channels : 123/364 [00:01<00:03,   70.24it/s]     34%|###4      | Channels : 125/364 [00:01<00:03,   70.38it/s]     35%|###4      | Channels : 127/364 [00:01<00:03,   70.99it/s]     35%|###5      | Channels : 128/364 [00:01<00:03,   70.09it/s]     36%|###5      | Channels : 130/364 [00:01<00:03,   70.46it/s]     36%|###6      | Channels : 132/364 [00:01<00:03,   70.32it/s]     37%|###6      | Channels : 133/364 [00:01<00:03,   69.69it/s]     37%|###7      | Channels : 135/364 [00:01<00:03,   70.29it/s]     37%|###7      | Channels : 136/364 [00:01<00:03,   69.74it/s]     38%|###7      | Channels : 137/364 [00:01<00:03,   68.64it/s]     38%|###8      | Channels : 139/364 [00:01<00:03,   68.63it/s]     38%|###8      | Channels : 140/364 [00:01<00:03,   68.03it/s]     39%|###9      | Channels : 142/364 [00:01<00:03,   68.61it/s]     39%|###9      | Channels : 143/364 [00:01<00:03,   67.87it/s]     40%|###9      | Channels : 145/364 [00:02<00:03,   67.96it/s]     40%|####      | Channels : 147/364 [00:02<00:03,   69.05it/s]     41%|####      | Channels : 148/364 [00:02<00:03,   68.57it/s]     41%|####      | Channels : 149/364 [00:02<00:03,   67.98it/s]     41%|####1     | Channels : 151/364 [00:02<00:03,   68.38it/s]     42%|####2     | Channels : 153/364 [00:02<00:03,   69.03it/s]     43%|####2     | Channels : 155/364 [00:02<00:03,   69.09it/s]     43%|####3     | Channels : 157/364 [00:02<00:02,   69.64it/s]     43%|####3     | Channels : 158/364 [00:02<00:02,   69.10it/s]     44%|####3     | Channels : 160/364 [00:02<00:02,   69.62it/s]     45%|####4     | Channels : 162/364 [00:02<00:02,   70.39it/s]     45%|####4     | Channels : 163/364 [00:02<00:02,   69.81it/s]     45%|####5     | Channels : 165/364 [00:02<00:02,   70.36it/s]     46%|####5     | Channels : 167/364 [00:02<00:02,   70.12it/s]     46%|####6     | Channels : 169/364 [00:02<00:02,   70.69it/s]     47%|####6     | Channels : 171/364 [00:02<00:02,   71.13it/s]     47%|####7     | Channels : 172/364 [00:02<00:02,   70.57it/s]     48%|####7     | Channels : 173/364 [00:02<00:02,   69.48it/s]     48%|####8     | Channels : 175/364 [00:02<00:02,   69.94it/s]     48%|####8     | Channels : 176/364 [00:02<00:02,   69.11it/s]     49%|####8     | Channels : 178/364 [00:02<00:02,   69.76it/s]     49%|####9     | Channels : 179/364 [00:02<00:02,   69.32it/s]     50%|####9     | Channels : 181/364 [00:02<00:02,   69.78it/s]     50%|#####     | Channels : 182/364 [00:02<00:02,   69.37it/s]     51%|#####     | Channels : 184/364 [00:02<00:02,   69.61it/s]     51%|#####1    | Channels : 186/364 [00:02<00:02,   70.19it/s]     51%|#####1    | Channels : 187/364 [00:02<00:02,   69.62it/s]     52%|#####1    | Channels : 188/364 [00:02<00:02,   68.77it/s]     52%|#####2    | Channels : 190/364 [00:02<00:02,   69.31it/s]     52%|#####2    | Channels : 191/364 [00:02<00:02,   68.78it/s]     53%|#####3    | Channels : 193/364 [00:02<00:02,   69.63it/s]     54%|#####3    | Channels : 195/364 [00:02<00:02,   70.17it/s]     54%|#####4    | Channels : 197/364 [00:02<00:02,   69.93it/s]     55%|#####4    | Channels : 199/364 [00:02<00:02,   70.40it/s]     55%|#####5    | Channels : 201/364 [00:02<00:02,   70.99it/s]     56%|#####5    | Channels : 203/364 [00:02<00:02,   70.65it/s]     56%|#####6    | Channels : 205/364 [00:02<00:02,   70.99it/s]     57%|#####6    | Channels : 206/364 [00:02<00:02,   70.41it/s]     57%|#####7    | Channels : 208/364 [00:02<00:02,   70.86it/s]     58%|#####7    | Channels : 210/364 [00:02<00:02,   71.34it/s]     58%|#####8    | Channels : 212/364 [00:02<00:02,   70.96it/s]     59%|#####8    | Channels : 214/364 [00:02<00:02,   71.13it/s]     59%|#####9    | Channels : 216/364 [00:02<00:02,   71.40it/s]     60%|#####9    | Channels : 217/364 [00:02<00:02,   70.68it/s]     60%|######    | Channels : 219/364 [00:03<00:02,   71.22it/s]     61%|######    | Channels : 221/364 [00:03<00:02,   71.00it/s]     61%|######1   | Channels : 223/364 [00:03<00:01,   71.11it/s]     62%|######1   | Channels : 224/364 [00:03<00:01,   70.62it/s]     62%|######2   | Channels : 226/364 [00:03<00:01,   70.73it/s]     62%|######2   | Channels : 227/364 [00:03<00:01,   69.84it/s]     63%|######2   | Channels : 229/364 [00:03<00:01,   70.33it/s]     63%|######3   | Channels : 231/364 [00:03<00:01,   71.13it/s]     64%|######4   | Channels : 233/364 [00:03<00:01,   70.78it/s]     65%|######4   | Channels : 235/364 [00:03<00:01,   70.89it/s]     65%|######5   | Channels : 237/364 [00:03<00:01,   71.24it/s]     65%|######5   | Channels : 238/364 [00:03<00:01,   70.42it/s]     66%|######5   | Channels : 239/364 [00:03<00:01,   69.89it/s]     66%|######6   | Channels : 241/364 [00:03<00:01,   70.17it/s]     66%|######6   | Channels : 242/364 [00:03<00:01,   69.59it/s]     67%|######7   | Channels : 244/364 [00:03<00:01,   69.46it/s]     67%|######7   | Channels : 245/364 [00:03<00:01,   68.62it/s]     68%|######7   | Channels : 247/364 [00:03<00:01,   68.15it/s]     68%|######8   | Channels : 249/364 [00:03<00:01,   68.91it/s]     69%|######8   | Channels : 250/364 [00:03<00:01,   68.55it/s]     69%|######8   | Channels : 251/364 [00:03<00:01,   67.92it/s]     70%|######9   | Channels : 253/364 [00:03<00:01,   68.25it/s]     70%|######9   | Channels : 254/364 [00:03<00:01,   65.80it/s]     70%|#######   | Channels : 256/364 [00:03<00:01,   65.96it/s]     71%|#######   | Channels : 257/364 [00:03<00:01,   65.05it/s]     71%|#######1  | Channels : 259/364 [00:03<00:01,   65.26it/s]     72%|#######1  | Channels : 261/364 [00:03<00:01,   65.45it/s]     72%|#######1  | Channels : 262/364 [00:03<00:01,   64.52it/s]     72%|#######2  | Channels : 263/364 [00:03<00:01,   62.56it/s]     73%|#######2  | Channels : 265/364 [00:03<00:01,   62.90it/s]     73%|#######3  | Channels : 266/364 [00:03<00:01,   60.75it/s]     74%|#######3  | Channels : 268/364 [00:03<00:01,   59.77it/s]     74%|#######3  | Channels : 269/364 [00:03<00:01,   58.32it/s]     74%|#######4  | Channels : 271/364 [00:03<00:01,   59.15it/s]     75%|#######5  | Channels : 273/364 [00:03<00:01,   60.00it/s]     76%|#######5  | Channels : 275/364 [00:03<00:01,   60.72it/s]     76%|#######6  | Channels : 277/364 [00:03<00:01,   61.75it/s]     77%|#######6  | Channels : 279/364 [00:03<00:01,   62.67it/s]     77%|#######7  | Channels : 281/364 [00:03<00:01,   63.37it/s]     77%|#######7  | Channels : 282/364 [00:03<00:01,   62.89it/s]     78%|#######7  | Channels : 283/364 [00:03<00:01,   62.65it/s]     78%|#######8  | Channels : 285/364 [00:03<00:01,   63.23it/s]     79%|#######8  | Channels : 287/364 [00:04<00:01,   64.00it/s]     79%|#######9  | Channels : 288/364 [00:04<00:01,   63.90it/s]     80%|#######9  | Channels : 290/364 [00:04<00:01,   64.62it/s]     80%|#######9  | Channels : 291/364 [00:04<00:01,   64.48it/s]     80%|########  | Channels : 292/364 [00:04<00:01,   64.32it/s]     81%|########  | Channels : 294/364 [00:04<00:01,   64.94it/s]     81%|########1 | Channels : 296/364 [00:04<00:01,   65.80it/s]     82%|########1 | Channels : 298/364 [00:04<00:01,   65.52it/s]     82%|########2 | Channels : 300/364 [00:04<00:00,   66.10it/s]     83%|########2 | Channels : 302/364 [00:04<00:00,   66.75it/s]     84%|########3 | Channels : 304/364 [00:04<00:00,   66.78it/s]     85%|########4 | Channels : 308/364 [00:04<00:00,   69.29it/s]     87%|########6 | Channels : 316/364 [00:04<00:00,   72.39it/s]     89%|########8 | Channels : 323/364 [00:04<00:00,   75.52it/s]     91%|######### | Channels : 330/364 [00:04<00:00,   78.76it/s]     92%|#########2| Channels : 336/364 [00:04<00:00,   82.00it/s]     94%|#########3| Channels : 342/364 [00:04<00:00,   85.30it/s]     96%|#########5| Channels : 348/364 [00:04<00:00,   88.62it/s]     97%|#########7| Channels : 354/364 [00:04<00:00,   91.98it/s]     99%|#########8| Channels : 360/364 [00:04<00:00,   95.44it/s]    100%|##########| Channels : 364/364 [00:04<00:00,   82.34it/s]
    Marking 0.00% of time points (0 segments) and 0/364 channels bad




By pressing the ``A`` key, you can toggle annotation mode to add, edit, or
remove experimental events, or to mark entire time periods as bad. Please see
the `MNE-Python Annotations tutorial`_ for an introduction to the interactive
interface. If you're closing the main window after changing the annotations,
you will be prompted whether you wish to save the changes. Your raw data and
the `*_events.tsv` sidecar file will be updated upon saving.

Non-interactive (programmatic) bad channel selection
----------------------------------------------------

Read the (now BIDS-formatted) data and print a list of channels currently
marked as bad.


.. code-block:: default


    raw = read_raw_bids(bids_path=bids_path, verbose=False)
    print(f'The following channels are currently marked as bad:\n'
          f'    {", ".join(raw.info["bads"])}\n')





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Opening raw data file /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_meg.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Reading events from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_events.tsv.
    Reading channel info from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_channels.tsv.
    /home/circleci/project/mne_bids/read.py:339: RuntimeWarning: The unit for channel(s) STI 001, STI 002, STI 003, STI 004, STI 005, STI 006, STI 014, STI 015, STI 016 has changed from V to NA.
      raw.set_channel_types(channel_type_dict)
    The following channels are currently marked as bad:
        MEG 2443, EEG 053





So currently, two channels are maked as bad: ``EEG 053`` and ``MEG 2443``.
Let's assume that through visual data inspection, we found that two more
MEG channels are problematic, and we would like to mark them as bad as well.
To do that, we simply add them to a list, which we then pass to
:func:`mne_bids.mark_bad_channels`:


.. code-block:: default


    bads = ['MEG 0112', 'MEG 0131']
    mark_bad_channels(ch_names=bads, bids_path=bids_path, verbose=False)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Processing channel MEG 0112:
        status: bad
        description: n/a
    Processing channel MEG 0131:
        status: bad
        description: n/a




That's it! Let's verify the result.


.. code-block:: default


    raw = read_raw_bids(bids_path=bids_path, verbose=False)
    print(f'After marking MEG 0112 and MEG 0131 as bad, the following channels '
          f'are now marked as bad:\n    {", ".join(raw.info["bads"])}\n')





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Opening raw data file /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_meg.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Reading events from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_events.tsv.
    Reading channel info from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_channels.tsv.
    /home/circleci/project/mne_bids/read.py:339: RuntimeWarning: The unit for channel(s) STI 001, STI 002, STI 003, STI 004, STI 005, STI 006, STI 014, STI 015, STI 016 has changed from V to NA.
      raw.set_channel_types(channel_type_dict)
    After marking MEG 0112 and MEG 0131 as bad, the following channels are now marked as bad:
        MEG 0112, MEG 0131, MEG 2443, EEG 053





As you can see, now a total of **four** channels is marked as bad: the ones
that were already bad when we started – ``EEG 053`` and ``MEG 2443`` – and
the two channels we passed to :func:`mne_bids.mark_bad_channels` –
``MEG 0112`` and ``MEG 0131``. This shows that marking bad channels via
:func:`mne_bids.mark_bad_channels`, by default, is an **additive** procedure,
which allows you to mark additional channels as bad while retaining the
information about all channels that had *previously* been marked as bad.

If you instead would like to **replace** the collection of bad channels
entirely, pass the argument ``overwrite=True``:


.. code-block:: default


    bads = ['MEG 0112', 'MEG 0131']
    mark_bad_channels(ch_names=bads, bids_path=bids_path, overwrite=True,
                      verbose=False)

    raw = read_raw_bids(bids_path=bids_path, verbose=False)
    print(f'After marking MEG 0112 and MEG 0131 as bad and passing '
          f'`overwrite=True`, the following channels '
          f'are now marked as bad:\n    {", ".join(raw.info["bads"])}\n')





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Resetting status and description for all channels.
    Processing channel MEG 0112:
        status: bad
        description: n/a
    Processing channel MEG 0131:
        status: bad
        description: n/a
    Opening raw data file /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_meg.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Reading events from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_events.tsv.
    Reading channel info from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_channels.tsv.
    /home/circleci/project/mne_bids/read.py:339: RuntimeWarning: The unit for channel(s) STI 001, STI 002, STI 003, STI 004, STI 005, STI 006, STI 014, STI 015, STI 016 has changed from V to NA.
      raw.set_channel_types(channel_type_dict)
    After marking MEG 0112 and MEG 0131 as bad and passing `overwrite=True`, the following channels are now marked as bad:
        MEG 0112, MEG 0131





Lastly, if you're looking for a way to mark all channels as good, simply
pass an empty list as ``ch_names``, combined with ``overwrite=True``:


.. code-block:: default


    bads = []
    mark_bad_channels(ch_names=bads, bids_path=bids_path, overwrite=True,
                      verbose=False)

    raw = read_raw_bids(bids_path=bids_path, verbose=False)
    print(f'After passing `ch_names=[]` and `overwrite=True`, the following '
          f'channels are now marked as bad:\n    {", ".join(raw.info["bads"])}\n')




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Resetting status and description for all channels.
    Opening raw data file /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_meg.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Reading events from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_events.tsv.
    Reading channel info from /home/circleci/mne_data/MNE-sample-data/../MNE-sample-data-bids/sub-01/ses-01/meg/sub-01_ses-01_task-audiovisual_run-01_channels.tsv.
    /home/circleci/project/mne_bids/read.py:339: RuntimeWarning: The unit for channel(s) STI 001, STI 002, STI 003, STI 004, STI 005, STI 006, STI 014, STI 015, STI 016 has changed from V to NA.
      raw.set_channel_types(channel_type_dict)
    After passing `ch_names=[]` and `overwrite=True`, the following channels are now marked as bad:
    






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  17.624 seconds)


.. _sphx_glr_download_auto_examples_mark_bad_channels.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example


  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/mne-tools/mne-bids/gh-pages?filepath=dev/notebooks/auto_examples/mark_bad_channels.ipynb
      :alt: Launch binder
      :width: 150 px


  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: mark_bad_channels.py <mark_bad_channels.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: mark_bad_channels.ipynb <mark_bad_channels.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
