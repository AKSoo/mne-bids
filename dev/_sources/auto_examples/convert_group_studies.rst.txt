.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_convert_group_studies.py>`     to download the full example code or to run this example in your browser via Binder
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_auto_examples_convert_group_studies.py:


=====================================
05. BIDS conversion for group studies
=====================================
Here, we show how to do BIDS conversion for group studies.
We will use the
`EEG Motor Movement/Imagery Dataset <https://doi.org/10.13026/C28G6P>`_
available on the PhysioBank database.
We recommend that you go through the more basic BIDS conversion example before
checking out this group conversion example: :ref:`ex-convert-mne-sample`


.. code-block:: default


    # Authors: Mainak Jas <mainak.jas@telecom-paristech.fr>
    #          Teon Brooks <teon.brooks@gmail.com>
    #          Stefan Appelhoff <stefan.appelhoff@mailbox.org>
    #
    # License: BSD (3-clause)








Let us import ``mne_bids``


.. code-block:: default


    import os.path as op

    import mne
    from mne.datasets import eegbci

    from mne_bids import (write_raw_bids, BIDSPath,
                          get_anonymization_daysback, make_report,
                          print_dir_tree)








And fetch the data for several subjects and runs of a single task.


.. code-block:: default


    subject_ids = [1, 2]

    # The run numbers in the eegbci are not consecutive ... we follow the online
    # documentation to get the 1st, 2nd, and 3rd run of one of the the motor
    # imagery task
    runs = [
        4,   # This is run #1 of imagining to open/close left or right fist
        8,   # ... run #2
        12,  # ... run #3
    ]

    # map the eegbci run numbers to the number of the run in the motor imagery task
    run_map = dict(zip(runs, range(1, 4)))

    for subject_id in subject_ids:
        eegbci.load_data(subject=subject_id, runs=runs, update_path=True)

    # get path to MNE directory with the downloaded example data
    mne_data_dir = mne.get_config('MNE_DATASETS_EEGBCI_PATH')
    data_dir = op.join(mne_data_dir, 'MNE-eegbci-data')





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://physionet.org/files/eegmmidb/1.0.0/S001/S001R04.edf (2.5 MB)
      0%|          | Downloading : 0.00/2.48M [00:00<?,        ?B/s]      2%|2         | Downloading : 56.0k/2.48M [00:00<00:01,    2.34MB/s]      5%|4         | Downloading : 120k/2.48M [00:00<00:01,    2.35MB/s]       9%|8         | Downloading : 216k/2.48M [00:00<00:00,    2.41MB/s]     11%|#1        | Downloading : 280k/2.48M [00:00<00:00,    2.44MB/s]     16%|#6        | Downloading : 408k/2.48M [00:00<00:00,    2.50MB/s]     21%|##1       | Downloading : 536k/2.48M [00:00<00:00,    2.57MB/s]     29%|##8       | Downloading : 728k/2.48M [00:00<00:00,    2.66MB/s]     34%|###3      | Downloading : 856k/2.48M [00:00<00:00,    2.73MB/s]     44%|####3     | Downloading : 1.09M/2.48M [00:00<00:00,    2.82MB/s]     54%|#####3    | Downloading : 1.34M/2.48M [00:00<00:00,    2.92MB/s]     59%|#####8    | Downloading : 1.46M/2.48M [00:00<00:00,    2.98MB/s]     64%|######4   | Downloading : 1.59M/2.48M [00:00<00:00,    3.06MB/s]     69%|######9   | Downloading : 1.71M/2.48M [00:00<00:00,    3.14MB/s]     74%|#######4  | Downloading : 1.84M/2.48M [00:00<00:00,    3.21MB/s]     79%|#######9  | Downloading : 1.96M/2.48M [00:00<00:00,    3.31MB/s]     89%|########9 | Downloading : 2.21M/2.48M [00:00<00:00,    3.41MB/s]     99%|#########9| Downloading : 2.46M/2.48M [00:00<00:00,    3.54MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    6.20MB/s]
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S001/S001R08.edf (2.5 MB)
      0%|          | Downloading : 0.00/2.48M [00:00<?,        ?B/s]      2%|2         | Downloading : 56.0k/2.48M [00:00<00:01,    2.25MB/s]      6%|5         | Downloading : 152k/2.48M [00:00<00:01,    2.31MB/s]      11%|#1        | Downloading : 280k/2.48M [00:00<00:00,    2.37MB/s]     16%|#6        | Downloading : 408k/2.48M [00:00<00:00,    2.44MB/s]     21%|##1       | Downloading : 536k/2.48M [00:00<00:00,    2.52MB/s]     26%|##6       | Downloading : 664k/2.48M [00:00<00:00,    2.60MB/s]     31%|###1      | Downloading : 792k/2.48M [00:00<00:00,    2.69MB/s]     36%|###6      | Downloading : 920k/2.48M [00:00<00:00,    2.78MB/s]     41%|####1     | Downloading : 1.02M/2.48M [00:00<00:00,    2.85MB/s]     51%|#####1    | Downloading : 1.27M/2.48M [00:00<00:00,    2.95MB/s]     62%|######1   | Downloading : 1.52M/2.48M [00:00<00:00,    3.04MB/s]     67%|######6   | Downloading : 1.65M/2.48M [00:00<00:00,    3.11MB/s]     77%|#######6  | Downloading : 1.90M/2.48M [00:00<00:00,    3.23MB/s]     87%|########6 | Downloading : 2.15M/2.48M [00:00<00:00,    3.35MB/s]     97%|#########6| Downloading : 2.40M/2.48M [00:00<00:00,    3.47MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    7.19MB/s]
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S001/S001R12.edf (2.5 MB)
      0%|          | Downloading : 0.00/2.48M [00:00<?,        ?B/s]      2%|2         | Downloading : 56.0k/2.48M [00:00<00:00,    3.29MB/s]      5%|4         | Downloading : 120k/2.48M [00:00<00:00,    3.28MB/s]       7%|7         | Downloading : 184k/2.48M [00:00<00:00,    3.29MB/s]     10%|9         | Downloading : 248k/2.48M [00:00<00:00,    3.31MB/s]     15%|#4        | Downloading : 376k/2.48M [00:00<00:00,    3.34MB/s]     20%|#9        | Downloading : 504k/2.48M [00:00<00:00,    3.39MB/s]     22%|##2       | Downloading : 568k/2.48M [00:00<00:00,    3.41MB/s]     25%|##4       | Downloading : 632k/2.48M [00:00<00:00,    3.43MB/s]     27%|##7       | Downloading : 696k/2.48M [00:00<00:00,    3.41MB/s]     30%|##9       | Downloading : 760k/2.48M [00:00<00:00,    3.41MB/s]     32%|###2      | Downloading : 824k/2.48M [00:00<00:00,    3.43MB/s]     38%|###7      | Downloading : 952k/2.48M [00:00<00:00,    3.49MB/s]     43%|####2     | Downloading : 1.05M/2.48M [00:00<00:00,    3.57MB/s]     48%|####7     | Downloading : 1.18M/2.48M [00:00<00:00,    3.64MB/s]     55%|#####5    | Downloading : 1.37M/2.48M [00:00<00:00,    3.73MB/s]     60%|######    | Downloading : 1.49M/2.48M [00:00<00:00,    3.82MB/s]     65%|######5   | Downloading : 1.62M/2.48M [00:00<00:00,    3.92MB/s]     70%|#######   | Downloading : 1.74M/2.48M [00:00<00:00,    4.02MB/s]     80%|########  | Downloading : 1.99M/2.48M [00:00<00:00,    4.13MB/s]     91%|######### | Downloading : 2.24M/2.48M [00:00<00:00,    4.25MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    4.38MB/s]    100%|##########| Downloading : 2.48M/2.48M [00:00<00:00,    5.68MB/s]
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S002/S002R04.edf (2.4 MB)
      0%|          | Downloading : 0.00/2.44M [00:00<?,        ?B/s]      2%|2         | Downloading : 56.0k/2.44M [00:00<00:01,    2.48MB/s]      6%|6         | Downloading : 152k/2.44M [00:00<00:00,    2.54MB/s]       9%|8         | Downloading : 216k/2.44M [00:00<00:00,    2.58MB/s]     14%|#3        | Downloading : 344k/2.44M [00:00<00:00,    2.64MB/s]     19%|#8        | Downloading : 472k/2.44M [00:00<00:00,    2.70MB/s]     27%|##6       | Downloading : 664k/2.44M [00:00<00:00,    2.78MB/s]     32%|###1      | Downloading : 792k/2.44M [00:00<00:00,    2.87MB/s]     37%|###6      | Downloading : 920k/2.44M [00:00<00:00,    2.97MB/s]     47%|####7     | Downloading : 1.15M/2.44M [00:00<00:00,    3.06MB/s]     57%|#####7    | Downloading : 1.40M/2.44M [00:00<00:00,    3.17MB/s]     68%|######7   | Downloading : 1.65M/2.44M [00:00<00:00,    3.28MB/s]     78%|#######7  | Downloading : 1.90M/2.44M [00:00<00:00,    3.39MB/s]     88%|########8 | Downloading : 2.15M/2.44M [00:00<00:00,    3.50MB/s]     98%|#########8| Downloading : 2.40M/2.44M [00:00<00:00,    3.62MB/s]    100%|##########| Downloading : 2.44M/2.44M [00:00<00:00,    7.21MB/s]
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S002/S002R08.edf (2.4 MB)
      0%|          | Downloading : 0.00/2.44M [00:00<?,        ?B/s]      2%|1         | Downloading : 40.0k/2.44M [00:00<00:01,    2.20MB/s]      4%|4         | Downloading : 104k/2.44M [00:00<00:01,    2.20MB/s]      13%|#3        | Downloading : 328k/2.44M [00:00<00:00,    2.29MB/s]     34%|###3      | Downloading : 840k/2.44M [00:00<00:00,    2.40MB/s]     75%|#######4  | Downloading : 1.82M/2.44M [00:00<00:00,    2.52MB/s]    100%|##########| Downloading : 2.44M/2.44M [00:00<00:00,    19.8MB/s]
    Downloading https://physionet.org/files/eegmmidb/1.0.0/S002/S002R12.edf (2.4 MB)
      0%|          | Downloading : 0.00/2.44M [00:00<?,        ?B/s]      2%|1         | Downloading : 40.0k/2.44M [00:00<00:01,    2.33MB/s]      5%|5         | Downloading : 136k/2.44M [00:00<00:01,    2.39MB/s]      11%|#         | Downloading : 264k/2.44M [00:00<00:00,    2.44MB/s]     16%|#5        | Downloading : 392k/2.44M [00:00<00:00,    2.51MB/s]     21%|##        | Downloading : 520k/2.44M [00:00<00:00,    2.58MB/s]     26%|##5       | Downloading : 648k/2.44M [00:00<00:00,    2.64MB/s]     31%|###1      | Downloading : 776k/2.44M [00:00<00:00,    2.68MB/s]     36%|###6      | Downloading : 904k/2.44M [00:00<00:00,    2.76MB/s]     41%|####1     | Downloading : 1.01M/2.44M [00:00<00:00,    2.84MB/s]     46%|####6     | Downloading : 1.13M/2.44M [00:00<00:00,    2.93MB/s]     52%|#####1    | Downloading : 1.26M/2.44M [00:00<00:00,    3.03MB/s]     62%|######1   | Downloading : 1.51M/2.44M [00:00<00:00,    3.13MB/s]     72%|#######2  | Downloading : 1.76M/2.44M [00:00<00:00,    3.24MB/s]     82%|########2 | Downloading : 2.01M/2.44M [00:00<00:00,    3.35MB/s]     93%|#########2| Downloading : 2.26M/2.44M [00:00<00:00,    3.47MB/s]    100%|##########| Downloading : 2.44M/2.44M [00:00<00:00,    3.58MB/s]    100%|##########| Downloading : 2.44M/2.44M [00:00<00:00,    6.62MB/s]




Define event_ids, this is knowledge we get from the online documentation of
the data as well.


.. code-block:: default


    event_id = {
        'imagine_motion_fist/left': 1,
        'imagine_motion_fist/right': 2,
    }








Let us loop over the subjects and create BIDS-compatible folder


.. code-block:: default


    # Make a path where we can save the data to
    bids_root = op.join(mne_data_dir, 'eegmmidb_bids_group_conversion')

    # Get a list of the raw objects for this dataset to use their dates
    # to determine the number of daysback to use to anonymize.
    # While we're looping through the files, also generate the
    # BIDS-compatible names that will be used to save the files in BIDS.
    raw_list = list()
    bids_list = list()
    for subject_id in subject_ids:
        for run in runs:
            raw_fname = eegbci.load_data(subject=subject_id, runs=run)[0]
            raw = mne.io.read_raw_edf(raw_fname)
            raw.info['line_freq'] = 50  # specify power line frequency
            raw_list.append(raw)
            bids_path = BIDSPath(subject=f'{subject_id:03}',
                                 session='01', task='MotorImagery',
                                 run=f'{run_map[run]:02}',
                                 root=bids_root)
            bids_list.append(bids_path)

    daysback_min, daysback_max = get_anonymization_daysback(raw_list)

    for raw, bids_path in zip(raw_list, bids_list):
        # By using the same anonymization `daysback` number we can
        # preserve the longitudinal structure of multiple sessions for a
        # single subject and the relation between subjects. Be sure to
        # change or delete this number before putting code online, you
        # wouldn't want to inadvertently de-anonymize your data.
        write_raw_bids(raw, bids_path, event_id=event_id,
                       anonymize=dict(daysback=daysback_min + 2117),
                       overwrite=True)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    /home/circleci/project/mne_bids/write.py:1039: RuntimeWarning: Converting to BV for anonymization
      warn('Converting to BV for anonymization')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/README'...

    References
    ----------
    Appelhoff, S., Sanderson, M., Brooks, T., Vliet, M., Quentin, R., Holdgraf, C., Chaumon, M., Mikulan, E., Tavabi, K., Höchenberger, R., Welke, D., Brunner, C., Rockhill, A., Larson, E., Gramfort, A. and Jas, M. (2019). MNE-BIDS: Organizing electrophysiological data into the BIDS format and facilitating their analysis. Journal of Open Source Software 4: (1896). https://doi.org/10.21105/joss.01896

    Pernet, C. R., Appelhoff, S., Gorgolewski, K. J., Flandin, G., Phillips, C., Delorme, A., Oostenveld, R. (2019). EEG-BIDS, an extension to the brain imaging data structure for electroencephalography. Scientific Data, 6, 103. https://doi.org/10.1038/s41597-019-0104-8


    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }
    /home/circleci/project/mne_bids/utils.py:237: RuntimeWarning: No events found or provided. Please make sure to set channel type using raw.set_channel_types or provide events_data.
      warn('No events found or provided. Please make sure to'

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 124.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-01_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    /home/circleci/project/mne_bids/write.py:1116: RuntimeWarning: Converting data files to BrainVision format
      warn('Converting data files to BrainVision format')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.vhdr    1919-03-16T16:15:00
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv entry with eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.vhdr.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    /home/circleci/project/mne_bids/write.py:1039: RuntimeWarning: Converting to BV for anonymization
      warn('Converting to BV for anonymization')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }
    /home/circleci/project/mne_bids/utils.py:237: RuntimeWarning: No events found or provided. Please make sure to set channel type using raw.set_channel_types or provide events_data.
      warn('No events found or provided. Please make sure to'

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-02_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 124.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-02_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    /home/circleci/project/mne_bids/write.py:1116: RuntimeWarning: Converting data files to BrainVision format
      warn('Converting data files to BrainVision format')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.vhdr    1919-03-16T16:15:00
    eeg/sub-001_ses-01_task-MotorImagery_run-02_eeg.vhdr    1919-03-16T16:15:00
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv entry with eeg/sub-001_ses-01_task-MotorImagery_run-02_eeg.vhdr.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    /home/circleci/project/mne_bids/write.py:1039: RuntimeWarning: Converting to BV for anonymization
      warn('Converting to BV for anonymization')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }
    /home/circleci/project/mne_bids/utils.py:237: RuntimeWarning: No events found or provided. Please make sure to set channel type using raw.set_channel_types or provide events_data.
      warn('No events found or provided. Please make sure to'

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-03_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 124.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-03_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    /home/circleci/project/mne_bids/write.py:1116: RuntimeWarning: Converting data files to BrainVision format
      warn('Converting data files to BrainVision format')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.vhdr    1919-03-16T16:15:00
    eeg/sub-001_ses-01_task-MotorImagery_run-02_eeg.vhdr    1919-03-16T16:15:00
    eeg/sub-001_ses-01_task-MotorImagery_run-03_eeg.vhdr    1919-03-16T16:15:00
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv entry with eeg/sub-001_ses-01_task-MotorImagery_run-03_eeg.vhdr.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    /home/circleci/project/mne_bids/write.py:1039: RuntimeWarning: Converting to BV for anonymization
      warn('Converting to BV for anonymization')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a
    sub-002 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }
    /home/circleci/project/mne_bids/utils.py:237: RuntimeWarning: No events found or provided. Please make sure to set channel type using raw.set_channel_types or provide events_data.
      warn('No events found or provided. Please make sure to'

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19679  =      0.000 ...   122.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 122.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-01_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    /home/circleci/project/mne_bids/write.py:1116: RuntimeWarning: Converting data files to BrainVision format
      warn('Converting data files to BrainVision format')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.vhdr    1919-03-16T16:15:00
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv entry with eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.vhdr.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    /home/circleci/project/mne_bids/write.py:1039: RuntimeWarning: Converting to BV for anonymization
      warn('Converting to BV for anonymization')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a
    sub-002 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }
    /home/circleci/project/mne_bids/utils.py:237: RuntimeWarning: No events found or provided. Please make sure to set channel type using raw.set_channel_types or provide events_data.
      warn('No events found or provided. Please make sure to'

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19679  =      0.000 ...   122.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-02_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 122.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-02_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    /home/circleci/project/mne_bids/write.py:1116: RuntimeWarning: Converting data files to BrainVision format
      warn('Converting data files to BrainVision format')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.vhdr    1919-03-16T16:15:00
    eeg/sub-002_ses-01_task-MotorImagery_run-02_eeg.vhdr    1919-03-16T16:15:00
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv entry with eeg/sub-002_ses-01_task-MotorImagery_run-02_eeg.vhdr.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    /home/circleci/project/mne_bids/write.py:1039: RuntimeWarning: Converting to BV for anonymization
      warn('Converting to BV for anonymization')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a
    sub-002 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }
    /home/circleci/project/mne_bids/utils.py:237: RuntimeWarning: No events found or provided. Please make sure to set channel type using raw.set_channel_types or provide events_data.
      warn('No events found or provided. Please make sure to'

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19679  =      0.000 ...   122.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-03_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 122.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-03_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     µV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    /home/circleci/project/mne_bids/write.py:1116: RuntimeWarning: Converting data files to BrainVision format
      warn('Converting data files to BrainVision format')

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.vhdr    1919-03-16T16:15:00
    eeg/sub-002_ses-01_task-MotorImagery_run-02_eeg.vhdr    1919-03-16T16:15:00
    eeg/sub-002_ses-01_task-MotorImagery_run-03_eeg.vhdr    1919-03-16T16:15:00
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv entry with eeg/sub-002_ses-01_task-MotorImagery_run-03_eeg.vhdr.




Now let's see the structure of the BIDS folder we created.


.. code-block:: default


    print_dir_tree(bids_root)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    |eegmmidb_bids_group_conversion/
    |--- README
    |--- dataset_description.json
    |--- participants.json
    |--- participants.tsv
    |--- sub-001/
    |------ ses-01/
    |--------- sub-001_ses-01_scans.tsv
    |--------- eeg/
    |------------ sub-001_ses-01_task-MotorImagery_run-01_channels.tsv
    |------------ sub-001_ses-01_task-MotorImagery_run-01_eeg.eeg
    |------------ sub-001_ses-01_task-MotorImagery_run-01_eeg.json
    |------------ sub-001_ses-01_task-MotorImagery_run-01_eeg.vhdr
    |------------ sub-001_ses-01_task-MotorImagery_run-01_eeg.vmrk
    |------------ sub-001_ses-01_task-MotorImagery_run-02_channels.tsv
    |------------ sub-001_ses-01_task-MotorImagery_run-02_eeg.eeg
    |------------ sub-001_ses-01_task-MotorImagery_run-02_eeg.json
    |------------ sub-001_ses-01_task-MotorImagery_run-02_eeg.vhdr
    |------------ sub-001_ses-01_task-MotorImagery_run-02_eeg.vmrk
    |------------ sub-001_ses-01_task-MotorImagery_run-03_channels.tsv
    |------------ sub-001_ses-01_task-MotorImagery_run-03_eeg.eeg
    |------------ sub-001_ses-01_task-MotorImagery_run-03_eeg.json
    |------------ sub-001_ses-01_task-MotorImagery_run-03_eeg.vhdr
    |------------ sub-001_ses-01_task-MotorImagery_run-03_eeg.vmrk
    |--- sub-002/
    |------ ses-01/
    |--------- sub-002_ses-01_scans.tsv
    |--------- eeg/
    |------------ sub-002_ses-01_task-MotorImagery_run-01_channels.tsv
    |------------ sub-002_ses-01_task-MotorImagery_run-01_eeg.eeg
    |------------ sub-002_ses-01_task-MotorImagery_run-01_eeg.json
    |------------ sub-002_ses-01_task-MotorImagery_run-01_eeg.vhdr
    |------------ sub-002_ses-01_task-MotorImagery_run-01_eeg.vmrk
    |------------ sub-002_ses-01_task-MotorImagery_run-02_channels.tsv
    |------------ sub-002_ses-01_task-MotorImagery_run-02_eeg.eeg
    |------------ sub-002_ses-01_task-MotorImagery_run-02_eeg.json
    |------------ sub-002_ses-01_task-MotorImagery_run-02_eeg.vhdr
    |------------ sub-002_ses-01_task-MotorImagery_run-02_eeg.vmrk
    |------------ sub-002_ses-01_task-MotorImagery_run-03_channels.tsv
    |------------ sub-002_ses-01_task-MotorImagery_run-03_eeg.eeg
    |------------ sub-002_ses-01_task-MotorImagery_run-03_eeg.json
    |------------ sub-002_ses-01_task-MotorImagery_run-03_eeg.vhdr
    |------------ sub-002_ses-01_task-MotorImagery_run-03_eeg.vmrk




Now let's generate a report on the dataset.


.. code-block:: default

    dataset_report = make_report(root=bids_root)
    print(dataset_report)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Summarizing participants.tsv /home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv...
    Summarizing scans.tsv files [PosixPath('/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv'), PosixPath('/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv')]...
    The participant template found: sex were all unknown;
    handedness were all unknown; ages all unknown
    This dataset was created with BIDS version 1.4.0 by Please cite MNE-BIDS in your
    publication before removing this (citations in README). This report was
    generated with MNE-BIDS (https://doi.org/10.21105/joss.01896). The dataset
    consists of 2 participants (sex were all unknown; handedness were all unknown;
    ages all unknown)and 1 recording sessions: 01. Data was recorded using a EEG
    system sampled at 160.0 Hz with line noise at 50 Hz. There were 6 scans in
    total. Recording durations ranged from 122.99 to 124.99 seconds (mean = 123.99,
    std = 1.0), for a total of 743.96 seconds of data recorded over all scans. For
    each dataset, there were on average 64.0 (std = 0.0) recording channels per
    scan, out of which 64.0 (std = 0.0) were used in analysis (0.0 +/- 0.0 were
    removed from analysis).





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  3.365 seconds)


.. _sphx_glr_download_auto_examples_convert_group_studies.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example


  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/mne-tools/mne-bids/gh-pages?filepath=dev/notebooks/auto_examples/convert_group_studies.ipynb
      :alt: Launch binder
      :width: 150 px


  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: convert_group_studies.py <convert_group_studies.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: convert_group_studies.ipynb <convert_group_studies.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
