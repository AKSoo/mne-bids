
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/convert_group_studies.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_convert_group_studies.py>`
        to download the full example code or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_convert_group_studies.py:


=====================================
05. BIDS conversion for group studies
=====================================
Here, we show how to do BIDS conversion for group studies.
We will use the
`EEG Motor Movement/Imagery Dataset <https://doi.org/10.13026/C28G6P>`_
available on the PhysioBank database.
We recommend that you go through the more basic BIDS conversion example before
checking out this group conversion example: :ref:`ex-convert-mne-sample`

.. GENERATED FROM PYTHON SOURCE LINES 12-19

.. code-block:: default


    # Authors: Mainak Jas <mainak.jas@telecom-paristech.fr>
    #          Teon Brooks <teon.brooks@gmail.com>
    #          Stefan Appelhoff <stefan.appelhoff@mailbox.org>
    #
    # License: BSD (3-clause)








.. GENERATED FROM PYTHON SOURCE LINES 20-21

Let us import ``mne_bids``

.. GENERATED FROM PYTHON SOURCE LINES 21-33

.. code-block:: default


    import os.path as op
    import shutil

    import mne
    from mne.datasets import eegbci

    from mne_bids import (write_raw_bids, BIDSPath,
                          get_anonymization_daysback, make_report,
                          print_dir_tree)
    from mne_bids.stats import count_events








.. GENERATED FROM PYTHON SOURCE LINES 34-35

And fetch the data for several subjects and runs of a single task.

.. GENERATED FROM PYTHON SOURCE LINES 35-57

.. code-block:: default


    subject_ids = [1, 2]

    # The run numbers in the eegbci are not consecutive ... we follow the online
    # documentation to get the 1st, 2nd, and 3rd run of one of the the motor
    # imagery task
    runs = [
        4,   # This is run #1 of imagining to open/close left or right fist
        8,   # ... run #2
        12,  # ... run #3
    ]

    # map the eegbci run numbers to the number of the run in the motor imagery task
    run_map = dict(zip(runs, range(1, 4)))

    for subject_id in subject_ids:
        eegbci.load_data(subject=subject_id, runs=runs, update_path=True)

    # get path to MNE directory with the downloaded example data
    mne_data_dir = mne.get_config('MNE_DATASETS_EEGBCI_PATH')
    data_dir = op.join(mne_data_dir, 'MNE-eegbci-data')








.. GENERATED FROM PYTHON SOURCE LINES 58-59

Let us loop over the subjects and create BIDS-compatible folder

.. GENERATED FROM PYTHON SOURCE LINES 59-63

.. code-block:: default


    # Make a path where we can save the data to
    bids_root = op.join(mne_data_dir, 'eegmmidb_bids_group_conversion')








.. GENERATED FROM PYTHON SOURCE LINES 64-69

To ensure the output path doesn't contain any leftover files from previous
tests and example runs, we simply delete it.

.. warning:: Do not delete directories that may contain important data!


.. GENERATED FROM PYTHON SOURCE LINES 69-73

.. code-block:: default


    if op.exists(bids_root):
        shutil.rmtree(bids_root)








.. GENERATED FROM PYTHON SOURCE LINES 74-78

Get a list of the raw objects for this dataset to use their dates
to determine the number of daysback to use to anonymize.
While we're looping through the files, also generate the
BIDS-compatible names that will be used to save the files in BIDS.

.. GENERATED FROM PYTHON SOURCE LINES 78-108

.. code-block:: default

    raw_list = list()
    bids_list = list()
    for subject_id in subject_ids:
        for run in runs:
            raw_fname = eegbci.load_data(subject=subject_id, runs=run)[0]
            raw = mne.io.read_raw_edf(raw_fname)
            raw.info['line_freq'] = 50  # specify power line frequency
            raw_list.append(raw)
            bids_path = BIDSPath(subject=f'{subject_id:03}',
                                 session='01', task='MotorImagery',
                                 run=f'{run_map[run]:02}',
                                 root=bids_root)
            bids_list.append(bids_path)

    daysback_min, daysback_max = get_anonymization_daysback(raw_list)

    for raw, bids_path in zip(raw_list, bids_list):
        # By using the same anonymization `daysback` number we can
        # preserve the longitudinal structure of multiple sessions for a
        # single subject and the relation between subjects. Be sure to
        # change or delete this number before putting code online, you
        # wouldn't want to inadvertently de-anonymize your data.
        #
        # Note that we do not need to pass any events, as teh dataset is already
        # equipped witn annotations, which wll be converted to BIDS events
        # automatically.
        write_raw_bids(raw, bids_path,
                       anonymize=dict(daysback=daysback_min + 2117),
                       overwrite=True)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/README'...

    References
    ----------
    Appelhoff, S., Sanderson, M., Brooks, T., Vliet, M., Quentin, R., Holdgraf, C., Chaumon, M., Mikulan, E., Tavabi, K., HÃ¶chenberger, R., Welke, D., Brunner, C., Rockhill, A., Larson, E., Gramfort, A. and Jas, M. (2019). MNE-BIDS: Organizing electrophysiological data into the BIDS format and facilitating their analysis. Journal of Open Source Software 4: (1896). https://doi.org/10.21105/joss.01896

    Pernet, C. R., Appelhoff, S., Gorgolewski, K. J., Flandin, G., Phillips, C., Delorme, A., Oostenveld, R. (2019). EEG-BIDS, an extension to the brain imaging data structure for electroencephalography. Scientific Data, 6, 103. https://doi.org/10.1038/s41597-019-0104-8


    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-01_events.tsv'...

    onset   duration        trial_type      value   sample
    0.0     4.2     T0      1       0
    4.2     4.1     T2      3       672
    8.3     4.2     T0      1       1328
    12.5    4.1     T1      2       2000
    16.6    4.2     T0      1       2656

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 124.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-01_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Copying data files to sub-001_ses-01_task-MotorImagery_run-01_eeg.edf
    /home/circleci/project/mne_bids/write.py:1323: RuntimeWarning: EDF/EDF+/BDF files contain two fields for recording dates.Due to file format limitations, one of these fields only supports 2-digit years. The date for that field will be set to 85 (i.e., 1985), the earliest possible date. The true anonymized date is stored in the scans.tsv file.
      warn("EDF/EDF+/BDF files contain two fields for recording dates."

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.edf     1919-03-16T16:15:00.000000Z
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv entry with eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.edf.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-02_events.tsv'...

    onset   duration        trial_type      value   sample
    0.0     4.2     T0      1       0
    4.2     4.1     T1      2       672
    8.3     4.2     T0      1       1328
    12.5    4.1     T2      3       2000
    16.6    4.2     T0      1       2656

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-02_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 124.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-02_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Copying data files to sub-001_ses-01_task-MotorImagery_run-02_eeg.edf
    /home/circleci/project/mne_bids/write.py:1323: RuntimeWarning: EDF/EDF+/BDF files contain two fields for recording dates.Due to file format limitations, one of these fields only supports 2-digit years. The date for that field will be set to 85 (i.e., 1985), the earliest possible date. The true anonymized date is stored in the scans.tsv file.
      warn("EDF/EDF+/BDF files contain two fields for recording dates."

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.edf     1919-03-16T16:15:00.000000Z
    eeg/sub-001_ses-01_task-MotorImagery_run-02_eeg.edf     1919-03-16T16:15:00.000000Z
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv entry with eeg/sub-001_ses-01_task-MotorImagery_run-02_eeg.edf.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S001/S001R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-03_events.tsv'...

    onset   duration        trial_type      value   sample
    0.0     4.2     T0      1       0
    4.2     4.1     T2      3       672
    8.3     4.2     T0      1       1328
    12.5    4.1     T1      2       2000
    16.6    4.2     T0      1       2656

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-03_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 124.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/eeg/sub-001_ses-01_task-MotorImagery_run-03_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Copying data files to sub-001_ses-01_task-MotorImagery_run-03_eeg.edf
    /home/circleci/project/mne_bids/write.py:1323: RuntimeWarning: EDF/EDF+/BDF files contain two fields for recording dates.Due to file format limitations, one of these fields only supports 2-digit years. The date for that field will be set to 85 (i.e., 1985), the earliest possible date. The true anonymized date is stored in the scans.tsv file.
      warn("EDF/EDF+/BDF files contain two fields for recording dates."

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-001_ses-01_task-MotorImagery_run-01_eeg.edf     1919-03-16T16:15:00.000000Z
    eeg/sub-001_ses-01_task-MotorImagery_run-02_eeg.edf     1919-03-16T16:15:00.000000Z
    eeg/sub-001_ses-01_task-MotorImagery_run-03_eeg.edf     1919-03-16T16:15:00.000000Z
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv entry with eeg/sub-001_ses-01_task-MotorImagery_run-03_eeg.edf.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a
    sub-002 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-01_events.tsv'...

    onset   duration        trial_type      value   sample
    0.0     4.1     T0      1       0
    4.1     4.1     T1      2       656
    8.2     4.1     T0      1       1312
    12.3    4.1     T2      3       1968
    16.4    4.1     T0      1       2624

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19679  =      0.000 ...   122.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 122.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-01_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Copying data files to sub-002_ses-01_task-MotorImagery_run-01_eeg.edf
    /home/circleci/project/mne_bids/write.py:1323: RuntimeWarning: EDF/EDF+/BDF files contain two fields for recording dates.Due to file format limitations, one of these fields only supports 2-digit years. The date for that field will be set to 85 (i.e., 1985), the earliest possible date. The true anonymized date is stored in the scans.tsv file.
      warn("EDF/EDF+/BDF files contain two fields for recording dates."

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.edf     1919-03-16T16:15:00.000000Z
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv entry with eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.edf.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a
    sub-002 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-02_events.tsv'...

    onset   duration        trial_type      value   sample
    0.0     4.1     T0      1       0
    4.1     4.1     T1      2       656
    8.2     4.1     T0      1       1312
    12.3    4.1     T2      3       1968
    16.4    4.1     T0      1       2624

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19679  =      0.000 ...   122.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-02_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 122.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-02_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Copying data files to sub-002_ses-01_task-MotorImagery_run-02_eeg.edf
    /home/circleci/project/mne_bids/write.py:1323: RuntimeWarning: EDF/EDF+/BDF files contain two fields for recording dates.Due to file format limitations, one of these fields only supports 2-digit years. The date for that field will be set to 85 (i.e., 1985), the earliest possible date. The true anonymized date is stored in the scans.tsv file.
      warn("EDF/EDF+/BDF files contain two fields for recording dates."

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.edf     1919-03-16T16:15:00.000000Z
    eeg/sub-002_ses-01_task-MotorImagery_run-02_eeg.edf     1919-03-16T16:15:00.000000Z
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv entry with eeg/sub-002_ses-01_task-MotorImagery_run-02_eeg.edf.
    Extracting EDF parameters from /home/circleci/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S002/S002R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv'...

    participant_id  age     sex     hand
    sub-001 n/a     n/a     n/a
    sub-002 n/a     n/a     n/a

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.json'...

    {
        "participant_id": {
            "Description": "Unique participant identifier"
        },
        "age": {
            "Description": "Age of the participant at time of testing",
            "Units": "years"
        },
        "sex": {
            "Description": "Biological sex of the participant",
            "Levels": {
                "F": "female",
                "M": "male"
            }
        },
        "hand": {
            "Description": "Handedness of the participant",
            "Levels": {
                "R": "right",
                "L": "left",
                "A": "ambidextrous"
            }
        }
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-03_events.tsv'...

    onset   duration        trial_type      value   sample
    0.0     4.1     T0      1       0
    4.1     4.1     T1      2       656
    8.2     4.1     T0      1       1312
    12.3    4.1     T2      3       1968
    16.4    4.1     T0      1       2624

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/dataset_description.json'...

    {
        "Name": " ",
        "BIDSVersion": "1.4.0",
        "DatasetType": "raw",
        "Authors": [
            "Please cite MNE-BIDS in your publication before removing this (citations in README)"
        ]
    }
    Reading 0 ... 19679  =      0.000 ...   122.994 secs...

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-03_eeg.json'...

    {
        "TaskName": "MotorImagery",
        "Manufacturer": "n/a",
        "PowerLineFrequency": 50,
        "SamplingFrequency": 160.0,
        "SoftwareFilters": "n/a",
        "RecordingDuration": 122.99375,
        "RecordingType": "continuous",
        "EEGReference": "n/a",
        "EEGGround": "n/a",
        "EEGPlacementScheme": "n/a",
        "EEGChannelCount": 64,
        "EOGChannelCount": 0,
        "ECGChannelCount": 0,
        "EMGChannelCount": 0,
        "MiscChannelCount": 0,
        "TriggerChannelCount": 0
    }

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/eeg/sub-002_ses-01_task-MotorImagery_run-03_channels.tsv'...

    name    type    units   low_cutoff      high_cutoff     description     sampling_frequency      status  status_description
    Fc5.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc3.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc1.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fcz.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Fc2.    EEG     ÂµV      0.0     80.0    ElectroEncephaloGram    160.0   good    n/a
    Copying data files to sub-002_ses-01_task-MotorImagery_run-03_eeg.edf
    /home/circleci/project/mne_bids/write.py:1323: RuntimeWarning: EDF/EDF+/BDF files contain two fields for recording dates.Due to file format limitations, one of these fields only supports 2-digit years. The date for that field will be set to 85 (i.e., 1985), the earliest possible date. The true anonymized date is stored in the scans.tsv file.
      warn("EDF/EDF+/BDF files contain two fields for recording dates."

    Writing '/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv'...

    filename        acq_time
    eeg/sub-002_ses-01_task-MotorImagery_run-01_eeg.edf     1919-03-16T16:15:00.000000Z
    eeg/sub-002_ses-01_task-MotorImagery_run-02_eeg.edf     1919-03-16T16:15:00.000000Z
    eeg/sub-002_ses-01_task-MotorImagery_run-03_eeg.edf     1919-03-16T16:15:00.000000Z
    Wrote /home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv entry with eeg/sub-002_ses-01_task-MotorImagery_run-03_eeg.edf.




.. GENERATED FROM PYTHON SOURCE LINES 109-110

Now let's see the structure of the BIDS folder we created.

.. GENERATED FROM PYTHON SOURCE LINES 110-113

.. code-block:: default


    print_dir_tree(bids_root)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    |eegmmidb_bids_group_conversion/
    |--- README
    |--- dataset_description.json
    |--- participants.json
    |--- participants.tsv
    |--- sub-001/
    |------ ses-01/
    |--------- sub-001_ses-01_scans.tsv
    |--------- eeg/
    |------------ sub-001_ses-01_task-MotorImagery_run-01_channels.tsv
    |------------ sub-001_ses-01_task-MotorImagery_run-01_eeg.edf
    |------------ sub-001_ses-01_task-MotorImagery_run-01_eeg.json
    |------------ sub-001_ses-01_task-MotorImagery_run-01_events.tsv
    |------------ sub-001_ses-01_task-MotorImagery_run-02_channels.tsv
    |------------ sub-001_ses-01_task-MotorImagery_run-02_eeg.edf
    |------------ sub-001_ses-01_task-MotorImagery_run-02_eeg.json
    |------------ sub-001_ses-01_task-MotorImagery_run-02_events.tsv
    |------------ sub-001_ses-01_task-MotorImagery_run-03_channels.tsv
    |------------ sub-001_ses-01_task-MotorImagery_run-03_eeg.edf
    |------------ sub-001_ses-01_task-MotorImagery_run-03_eeg.json
    |------------ sub-001_ses-01_task-MotorImagery_run-03_events.tsv
    |--- sub-002/
    |------ ses-01/
    |--------- sub-002_ses-01_scans.tsv
    |--------- eeg/
    |------------ sub-002_ses-01_task-MotorImagery_run-01_channels.tsv
    |------------ sub-002_ses-01_task-MotorImagery_run-01_eeg.edf
    |------------ sub-002_ses-01_task-MotorImagery_run-01_eeg.json
    |------------ sub-002_ses-01_task-MotorImagery_run-01_events.tsv
    |------------ sub-002_ses-01_task-MotorImagery_run-02_channels.tsv
    |------------ sub-002_ses-01_task-MotorImagery_run-02_eeg.edf
    |------------ sub-002_ses-01_task-MotorImagery_run-02_eeg.json
    |------------ sub-002_ses-01_task-MotorImagery_run-02_events.tsv
    |------------ sub-002_ses-01_task-MotorImagery_run-03_channels.tsv
    |------------ sub-002_ses-01_task-MotorImagery_run-03_eeg.edf
    |------------ sub-002_ses-01_task-MotorImagery_run-03_eeg.json
    |------------ sub-002_ses-01_task-MotorImagery_run-03_events.tsv




.. GENERATED FROM PYTHON SOURCE LINES 114-115

Now let's get an overview of the events on the whole dataset

.. GENERATED FROM PYTHON SOURCE LINES 115-119

.. code-block:: default


    counts = count_events(bids_root)
    counts






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th colspan="3" halign="left">MotorImagery</th>
        </tr>
        <tr>
          <th></th>
          <th></th>
          <th>trial_type</th>
          <th>T0</th>
          <th>T1</th>
          <th>T2</th>
        </tr>
        <tr>
          <th>subject</th>
          <th>session</th>
          <th>run</th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th rowspan="3" valign="top">001</th>
          <th rowspan="3" valign="top">01</th>
          <th>01</th>
          <td>15</td>
          <td>8</td>
          <td>7</td>
        </tr>
        <tr>
          <th>02</th>
          <td>15</td>
          <td>8</td>
          <td>7</td>
        </tr>
        <tr>
          <th>03</th>
          <td>15</td>
          <td>7</td>
          <td>8</td>
        </tr>
        <tr>
          <th rowspan="3" valign="top">002</th>
          <th rowspan="3" valign="top">01</th>
          <th>01</th>
          <td>15</td>
          <td>7</td>
          <td>8</td>
        </tr>
        <tr>
          <th>02</th>
          <td>15</td>
          <td>8</td>
          <td>7</td>
        </tr>
        <tr>
          <th>03</th>
          <td>15</td>
          <td>8</td>
          <td>7</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 120-121

Now let's generate a report on the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. code-block:: default

    dataset_report = make_report(root=bids_root)
    print(dataset_report)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Summarizing participants.tsv /home/circleci/mne_data/eegmmidb_bids_group_conversion/participants.tsv...
    Summarizing scans.tsv files [PosixPath('/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-001/ses-01/sub-001_ses-01_scans.tsv'), PosixPath('/home/circleci/mne_data/eegmmidb_bids_group_conversion/sub-002/ses-01/sub-002_ses-01_scans.tsv')]...
    The participant template found: sex were all unknown;
    handedness were all unknown; ages all unknown
    This dataset was created with BIDS version 1.4.0 by Please cite MNE-BIDS in your
    publication before removing this (citations in README). This report was
    generated with MNE-BIDS (https://doi.org/10.21105/joss.01896). The dataset
    consists of 2 participants (sex were all unknown; handedness were all unknown;
    ages all unknown)and 1 recording sessions: 01. Data was recorded using a EEG
    system sampled at 160.0 Hz with line noise at 50 Hz. There were 6 scans in
    total. Recording durations ranged from 122.99 to 124.99 seconds (mean = 123.99,
    std = 1.0), for a total of 743.96 seconds of data recorded over all scans. For
    each dataset, there were on average 64.0 (std = 0.0) recording channels per
    scan, out of which 64.0 (std = 0.0) were used in analysis (0.0 +/- 0.0 were
    removed from analysis).





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.417 seconds)


.. _sphx_glr_download_auto_examples_convert_group_studies.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example


  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/mne-tools/mne-bids/gh-pages?filepath=dev/notebooks/auto_examples/convert_group_studies.ipynb
      :alt: Launch binder
      :width: 150 px


  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: convert_group_studies.py <convert_group_studies.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: convert_group_studies.ipynb <convert_group_studies.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
